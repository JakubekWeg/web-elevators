(()=>{"use strict";var e={316:function(e,t,n){var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};t.__esModule=!0,t.Elevator=t.ElevatorDirection=void 0;var a,d=n(50),s=n(882);!function(e){e[e.Standing=0]="Standing",e[e.GoingUp=1]="GoingUp",e[e.GoingDown=-1]="GoingDown"}(a=t.ElevatorDirection||(t.ElevatorDirection={}));var l=function(e){this.id=e,this.currentFloor=0,this.direction=a.Standing,this.nextDirection=a.Standing,this.destinationLimit=Number.MAX_SAFE_INTEGER,this.passengers=[]};t.Elevator=l;var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.elevators=new Map,t.waitingPassengers=[],t}return r(t,e),t.prototype.addNewElevator=function(e){var t=s.generateUniqueId(),n=new l(t);n.currentFloor=+e||0,this.elevators.set(t,n),this.emit("elevator-added",n)},t.prototype.addNewPassenger=function(e){var t=e.name,n=e.initialFloor,i=e.destinationFloor;if(isNaN(n)||isNaN(i))throw new Error("Invalid passengers parameters");if(n===i)throw new Error("Passenger is already on the destination floor");var r={id:s.generateUniqueId(),direction:i<n?a.GoingDown:a.GoingUp,name:t,initialFloor:n,destinationFloor:i};this.waitingPassengers.unshift(r),this.emit("waiting-passenger-added",r)},t.prototype.commitNextStep=function(){var e,t,n,i,r,d,s,l,c,u,v=new Set;try{for(var p=o(this.elevators.values()),g=p.next();!g.done;g=p.next())if((F=g.value).direction!==a.Standing){v.add(F.id),F.currentFloor+=F.direction;for(var f=F.passengers.length-1;f>=0;f--)(D=F.passengers[f]).destinationFloor===F.currentFloor&&(F.passengers.splice(f,1),this.emit("passenger-dropped",{passenger:D,elevator:F}));if(F.nextDirection!==a.Standing&&F.currentFloor===F.destinationLimit)F.direction=F.nextDirection,F.nextDirection=a.Standing,F.destinationLimit=Number.MAX_SAFE_INTEGER*F.direction;else if(0===F.passengers.length)if(F.nextDirection!==a.Standing);else{var h=!1,m=F.currentFloor*F.direction;try{for(var y=(n=void 0,o(this.waitingPassengers)),E=y.next();!E.done;E=y.next())if((D=E.value).initialFloor*F.direction>=m&&D.direction===F.direction&&D.destinationFloor*F.direction<=F.destinationLimit*F.direction){h=!0;break}}catch(e){n={error:e}}finally{try{E&&!E.done&&(i=y.return)&&i.call(y)}finally{if(n)throw n.error}}h||(F.direction=a.Standing)}for(f=this.waitingPassengers.length-1;f>=0;f--)(D=this.waitingPassengers[f]).initialFloor===F.currentFloor&&D.direction===F.direction&&D.destinationFloor*F.direction<F.destinationLimit*F.direction&&(F.passengers.push(D),this.waitingPassengers.splice(f,1),this.emit("passenger-taken",{passenger:D,elevator:F}))}}catch(t){e={error:t}}finally{try{g&&!g.done&&(t=p.return)&&t.call(p)}finally{if(e)throw e.error}}try{for(var w=o(this.elevators.values()),x=w.next();!x.done;x=w.next()){var F;if((F=x.value).direction==a.Standing){var S=function(e){var t,n,i=!1;try{for(var r=(t=void 0,o(_.elevators.values())),d=r.next();!d.done;d=r.next()){var s=d.value;if(s.direction!==a.Standing&&e.initialFloor*s.direction>s.currentFloor*s.direction&&e.destinationFloor*F.direction<=s.destinationLimit*s.direction&&e.direction===s.direction||s.direction!==a.Standing&&s.nextDirection!==a.Standing&&e.initialFloor*s.direction<=s.destinationLimit*s.direction&&e.direction===s.nextDirection){i=!0;break}}}catch(e){t={error:e}}finally{try{d&&!d.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}if(!i){if(F.direction=Math.sign(e.initialFloor-F.currentFloor),0===F.direction){F.direction=Math.sign(e.destinationFloor-e.initialFloor);for(var l=_.waitingPassengers.length-1;l>=0;l--){var c=_.waitingPassengers[l];c.initialFloor===F.currentFloor&&c.direction===F.direction&&(F.passengers.push(c),_.waitingPassengers.splice(l,1),_.emit("passenger-taken",{passenger:c,elevator:F}))}}if(F.nextDirection=Math.sign(e.destinationFloor-e.initialFloor),F.nextDirection===F.direction)F.nextDirection=a.Standing,F.destinationLimit=Number.MAX_SAFE_INTEGER*F.direction;else{var u=e.initialFloor;_.waitingPassengers.forEach(F.direction===a.GoingUp?function(e){e.initialFloor>u&&(u=e.initialFloor)}:function(e){e.initialFloor<u&&(u=e.initialFloor)}),F.destinationLimit=u}return v.add(F.id),"break"}},_=this;try{for(var b=(s=void 0,o(this.waitingPassengers)),L=b.next();!L.done;L=b.next()){var D;if("break"===S(D=L.value))break}}catch(e){s={error:e}}finally{try{L&&!L.done&&(l=b.return)&&l.call(b)}finally{if(s)throw s.error}}}}}catch(e){r={error:e}}finally{try{x&&!x.done&&(d=w.return)&&d.call(w)}finally{if(r)throw r.error}}try{for(var T=o(v),N=T.next();!N.done;N=T.next()){var C=N.value;this.emit("elevator-updated",this.elevators.get(C))}}catch(e){c={error:e}}finally{try{N&&!N.done&&(u=T.return)&&u.call(T)}finally{if(c)throw c.error}}},t}(d.default);t.default=c},50:function(e,t){var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};t.__esModule=!0;var i=function(){function e(){this.listeners=new Map}return e.prototype.addEventListener=function(e,t){var n,i=null!==(n=this.listeners.get(e))&&void 0!==n?n:[];i.push(t),this.listeners.set(e,i)},e.prototype.emit=function(e,t){var i,r,o;try{for(var a=n(null!==(o=this.listeners.get(e))&&void 0!==o?o:[]),d=a.next();!d.done;d=a.next())(0,d.value)(t)}catch(e){i={error:e}}finally{try{d&&!d.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}},e}();t.default=i},882:(e,t)=>{t.__esModule=!0,t.generateUniqueId=void 0;var n=1;t.generateUniqueId=function(){return n++}}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,n),o.exports}(()=>{var e=n(316);document.querySelector("main").style.display=null;var t=new e.default,i=document.getElementById("elevators-list"),r=document.getElementById("waiting-passengers-list"),o=function(t){switch(t){case e.ElevatorDirection.GoingUp:return"up";case e.ElevatorDirection.GoingDown:return"down";case e.ElevatorDirection.Standing:return"none"}};document.getElementById("add-elevator-btn").addEventListener("click",(function(){t.addNewElevator(+prompt("What floor is that elevator initially on?"))})),document.getElementById("add-passenger-btn").addEventListener("click",(function(){t.addNewPassenger({name:prompt("Give a passenger name","")||"",initialFloor:+prompt("That floor is that passenger on?"),destinationFloor:+prompt("That floor is that passenger going to go?")})})),document.getElementById("next-step-btn").addEventListener("click",(function(){return t.commitNextStep()})),t.addEventListener("elevator-added",(function(e){var t,n=document.createElement("div");n.id="elevator-id-"+e.id,n.classList.add("elevator"),(t=document.createElement("div")).classList.add("current-floor-value"),t.innerText=""+e.currentFloor,n.appendChild(t),(t=document.createElement("div")).innerText="Current floor",n.appendChild(t),(t=document.createElement("div")).classList.add("direction-value"),t.innerText=""+o(e.direction),n.appendChild(t),(t=document.createElement("div")).innerText="Direction",n.appendChild(t),(t=document.createElement("div")).classList.add("passengers-inside-list"),n.appendChild(t),i.appendChild(n)})),t.addEventListener("elevator-updated",(function(e){var t=document.getElementById("elevator-id-"+e.id);t.querySelector(".current-floor-value").innerText=""+e.currentFloor,t.querySelector(".direction-value").innerText=""+o(e.direction)})),t.addEventListener("waiting-passenger-added",(function(e){var t,n=document.createElement("div");n.id="waiting-passenger-id-"+e.id,n.classList.add("waiting-passenger"),(t=document.createElement("div")).innerText=""+e.name,n.appendChild(t),(t=document.createElement("div")).innerText="Name",n.appendChild(t),(t=document.createElement("div")).innerText=""+e.initialFloor,n.appendChild(t),(t=document.createElement("div")).innerText="Waiting at",n.appendChild(t),(t=document.createElement("div")).innerText=""+e.destinationFloor,n.appendChild(t),(t=document.createElement("div")).innerText="Destination floor",n.appendChild(t),r.appendChild(n)})),t.addEventListener("passenger-taken",(function(e){var t=e.passenger,n=e.elevator;document.getElementById("waiting-passenger-id-"+t.id).remove();var i=document.querySelector("#elevator-id-"+n.id+" .passengers-inside-list"),r=document.createElement("div");r.id="passenger_"+t.id,r.classList.add("passenger-inside"),r.innerText=t.name+" ("+t.destinationFloor+")",i.appendChild(r)})),t.addEventListener("passenger-dropped",(function(e){var t=e.passenger,n=e.elevator;document.querySelector("#elevator-id-"+n.id+" #passenger_"+t.id).remove()}))})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWItZWxldmF0b3JzLy4vc3JjL2VsZXZhdG9yLXN5c3RlbS50cyIsIndlYnBhY2s6Ly93ZWItZWxldmF0b3JzLy4vc3JjL2V2ZW50LXByb2R1Y2VyLnRzIiwid2VicGFjazovL3dlYi1lbGV2YXRvcnMvLi9zcmMvdXRpbC50cyIsIndlYnBhY2s6Ly93ZWItZWxldmF0b3JzL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3dlYi1lbGV2YXRvcnMvLi9zcmMvbWFpbi50cyJdLCJuYW1lcyI6WyJleHRlbmRTdGF0aWNzIiwiX19leHRlbmRzIiwidGhpcyIsImQiLCJiIiwiT2JqZWN0Iiwic2V0UHJvdG90eXBlT2YiLCJfX3Byb3RvX18iLCJBcnJheSIsInAiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJUeXBlRXJyb3IiLCJTdHJpbmciLCJfXyIsImNvbnN0cnVjdG9yIiwiY3JlYXRlIiwiX192YWx1ZXMiLCJvIiwicyIsIlN5bWJvbCIsIml0ZXJhdG9yIiwibSIsImkiLCJsZW5ndGgiLCJuZXh0IiwidmFsdWUiLCJkb25lIiwiZXhwb3J0cyIsIl9fZXNNb2R1bGUiLCJFbGV2YXRvciIsIkVsZXZhdG9yRGlyZWN0aW9uIiwiZXZlbnRfcHJvZHVjZXJfMSIsInV0aWxfMSIsImlkIiwiY3VycmVudEZsb29yIiwiZGlyZWN0aW9uIiwiU3RhbmRpbmciLCJuZXh0RGlyZWN0aW9uIiwiZGVzdGluYXRpb25MaW1pdCIsIk51bWJlciIsIk1BWF9TQUZFX0lOVEVHRVIiLCJwYXNzZW5nZXJzIiwiRWxldmF0b3JTeXN0ZW0iLCJfc3VwZXIiLCJfdGhpcyIsImFwcGx5IiwiYXJndW1lbnRzIiwiZWxldmF0b3JzIiwiTWFwIiwid2FpdGluZ1Bhc3NlbmdlcnMiLCJhZGROZXdFbGV2YXRvciIsImluaXRpYWxGbG9vciIsImdlbmVyYXRlVW5pcXVlSWQiLCJvYmoiLCJzZXQiLCJlbWl0IiwiYWRkTmV3UGFzc2VuZ2VyIiwiX2EiLCJuYW1lIiwiZGVzdGluYXRpb25GbG9vciIsImlzTmFOIiwiRXJyb3IiLCJwYXNzZW5nZXIiLCJHb2luZ0Rvd24iLCJHb2luZ1VwIiwidW5zaGlmdCIsImNvbW1pdE5leHRTdGVwIiwiZV8xIiwiZV8yIiwiX2IiLCJlXzMiLCJfYyIsImVfNCIsIl9kIiwiZV81IiwiX2UiLCJjaGFuZ2VkRWxldmF0b3JJZHMiLCJTZXQiLCJfZiIsInZhbHVlcyIsIl9nIiwiZWxldmF0b3IiLCJhZGQiLCJzcGxpY2UiLCJpc1NvbWVvbmUiLCJ0bXAiLCJfaCIsIl9qIiwiZV8yXzEiLCJlcnJvciIsInB1c2giLCJlXzFfMSIsIl9rIiwiX2wiLCJfbG9vcF8xIiwiZV82IiwiX3AiLCJpc0FueSIsIl9xIiwidGhpc18xIiwiX3IiLCJvdGhlckVsZXZhdG9yIiwiZV82XzEiLCJNYXRoIiwic2lnbiIsInBhc3Nlbmdlcl8xIiwibGltaXRfMSIsImZvckVhY2giLCJfbSIsIl9vIiwiZV80XzEiLCJlXzNfMSIsImNoYW5nZWRFbGV2YXRvcklkc18xIiwiY2hhbmdlZEVsZXZhdG9ySWRzXzFfMSIsImdldCIsImVfNV8xIiwiRXZlbnRQcm9kdWNlciIsImxpc3RlbmVycyIsImFkZEV2ZW50TGlzdGVuZXIiLCJ0eXBlIiwibGlzdGVuZXIiLCJsaXN0IiwiZXZlbnQiLCJsIiwibmV4dElkIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwidW5kZWZpbmVkIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsImVsZXZhdG9yX3N5c3RlbV8xIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwic3R5bGUiLCJkaXNwbGF5Iiwic3lzdGVtIiwiZWxldmF0b3JzTGlzdERpdiIsImdldEVsZW1lbnRCeUlkIiwid2FpdGluZ1Bhc3NlbmdlcnNMaXN0RGl2IiwiZm9ybWF0RGlyZWN0aW9uIiwiZGlyIiwicHJvbXB0IiwiZWwiLCJlbGV2YXRvckRpdiIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJpbm5lclRleHQiLCJhcHBlbmRDaGlsZCIsInJlbW92ZSIsImxpc3RPZkluc2lkZXJzIl0sIm1hcHBpbmdzIjoiOENBQ0EsSUFDUUEsRUFESkMsRUFBYUMsTUFBUUEsS0FBS0QsWUFDdEJELEVBQWdCLFNBQVVHLEVBQUdDLEdBSTdCLE9BSEFKLEVBQWdCSyxPQUFPQyxnQkFDbEIsQ0FBRUMsVUFBVyxjQUFnQkMsT0FBUyxTQUFVTCxFQUFHQyxHQUFLRCxFQUFFSSxVQUFZSCxJQUN2RSxTQUFVRCxFQUFHQyxHQUFLLElBQUssSUFBSUssS0FBS0wsRUFBT0MsT0FBT0ssVUFBVUMsZUFBZUMsS0FBS1IsRUFBR0ssS0FBSU4sRUFBRU0sR0FBS0wsRUFBRUssTUFDM0VOLEVBQUdDLElBRXJCLFNBQVVELEVBQUdDLEdBQ2hCLEdBQWlCLG1CQUFOQSxHQUEwQixPQUFOQSxFQUMzQixNQUFNLElBQUlTLFVBQVUsdUJBQXlCQyxPQUFPVixHQUFLLGlDQUU3RCxTQUFTVyxJQUFPYixLQUFLYyxZQUFjYixFQURuQ0gsRUFBY0csRUFBR0MsR0FFakJELEVBQUVPLFVBQWtCLE9BQU5OLEVBQWFDLE9BQU9ZLE9BQU9iLElBQU1XLEVBQUdMLFVBQVlOLEVBQUVNLFVBQVcsSUFBSUssS0FHbkZHLEVBQVloQixNQUFRQSxLQUFLZ0IsVUFBYSxTQUFTQyxHQUMvQyxJQUFJQyxFQUFzQixtQkFBWEMsUUFBeUJBLE9BQU9DLFNBQVVDLEVBQUlILEdBQUtELEVBQUVDLEdBQUlJLEVBQUksRUFDNUUsR0FBSUQsRUFBRyxPQUFPQSxFQUFFWCxLQUFLTyxHQUNyQixHQUFJQSxHQUF5QixpQkFBYkEsRUFBRU0sT0FBcUIsTUFBTyxDQUMxQ0MsS0FBTSxXQUVGLE9BRElQLEdBQUtLLEdBQUtMLEVBQUVNLFNBQVFOLE9BQUksR0FDckIsQ0FBRVEsTUFBT1IsR0FBS0EsRUFBRUssS0FBTUksTUFBT1QsS0FHNUMsTUFBTSxJQUFJTixVQUFVTyxFQUFJLDBCQUE0QixvQ0FFeERTLEVB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QUFTaEQsR0FBSyxlQUFpQjZCLEVBQVU3QixJQUFJcUgsYSIsImZpbGUiOiJidW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG52YXIgX192YWx1ZXMgPSAodGhpcyAmJiB0aGlzLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7XG4gICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDtcbiAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTtcbiAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09IFwibnVtYmVyXCIpIHJldHVybiB7XG4gICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7XG4gICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IocyA/IFwiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS5cIiA6IFwiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcbn07XG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuZXhwb3J0cy5FbGV2YXRvciA9IGV4cG9ydHMuRWxldmF0b3JEaXJlY3Rpb24gPSB2b2lkIDA7XG52YXIgZXZlbnRfcHJvZHVjZXJfMSA9IHJlcXVpcmUoXCIuL2V2ZW50LXByb2R1Y2VyXCIpO1xudmFyIHV0aWxfMSA9IHJlcXVpcmUoXCIuL3V0aWxcIik7XG52YXIgRWxldmF0b3JEaXJlY3Rpb247XG4oZnVuY3Rpb24gKEVsZXZhdG9yRGlyZWN0aW9uKSB7XG4gICAgRWxldmF0b3JEaXJlY3Rpb25bRWxldmF0b3JEaXJlY3Rpb25bXCJTdGFuZGluZ1wiXSA9IDBdID0gXCJTdGFuZGluZ1wiO1xuICAgIEVsZXZhdG9yRGlyZWN0aW9uW0VsZXZhdG9yRGlyZWN0aW9uW1wiR29pbmdVcFwiXSA9IDFdID0gXCJHb2luZ1VwXCI7XG4gICAgRWxldmF0b3JEaXJlY3Rpb25bRWxldmF0b3JEaXJlY3Rpb25bXCJHb2luZ0Rvd25cIl0gPSAtMV0gPSBcIkdvaW5nRG93blwiO1xufSkoRWxldmF0b3JEaXJlY3Rpb24gPSBleHBvcnRzLkVsZXZhdG9yRGlyZWN0aW9uIHx8IChleHBvcnRzLkVsZXZhdG9yRGlyZWN0aW9uID0ge30pKTtcbnZhciBFbGV2YXRvciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBFbGV2YXRvcihpZCkge1xuICAgICAgICB0aGlzLmlkID0gaWQ7XG4gICAgICAgIHRoaXMuY3VycmVudEZsb29yID0gMDtcbiAgICAgICAgdGhpcy5kaXJlY3Rpb24gPSBFbGV2YXRvckRpcmVjdGlvbi5TdGFuZGluZztcbiAgICAgICAgdGhpcy5uZXh0RGlyZWN0aW9uID0gRWxldmF0b3JEaXJlY3Rpb24uU3RhbmRpbmc7XG4gICAgICAgIHRoaXMuZGVzdGluYXRpb25MaW1pdCA9IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSO1xuICAgICAgICB0aGlzLnBhc3NlbmdlcnMgPSBbXTtcbiAgICB9XG4gICAgcmV0dXJuIEVsZXZhdG9yO1xufSgpKTtcbmV4cG9ydHMuRWxldmF0b3IgPSBFbGV2YXRvcjtcbnZhciBFbGV2YXRvclN5c3RlbSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoRWxldmF0b3JTeXN0ZW0sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gRWxldmF0b3JTeXN0ZW0oKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgICAgICAvLyBpZCB0byBFbGV2YXRvclxuICAgICAgICBfdGhpcy5lbGV2YXRvcnMgPSBuZXcgTWFwKCk7XG4gICAgICAgIF90aGlzLndhaXRpbmdQYXNzZW5nZXJzID0gW107XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgRWxldmF0b3JTeXN0ZW0ucHJvdG90eXBlLmFkZE5ld0VsZXZhdG9yID0gZnVuY3Rpb24gKGluaXRpYWxGbG9vcikge1xuICAgICAgICB2YXIgaWQgPSB1dGlsXzEuZ2VuZXJhdGVVbmlxdWVJZCgpO1xuICAgICAgICB2YXIgb2JqID0gbmV3IEVsZXZhdG9yKGlkKTtcbiAgICAgICAgb2JqLmN1cnJlbnRGbG9vciA9ICtpbml0aWFsRmxvb3IgfHwgMDtcbiAgICAgICAgdGhpcy5lbGV2YXRvcnMuc2V0KGlkLCBvYmopO1xuICAgICAgICB0aGlzLmVtaXQoJ2VsZXZhdG9yLWFkZGVkJywgb2JqKTtcbiAgICB9O1xuICAgIEVsZXZhdG9yU3lzdGVtLnByb3RvdHlwZS5hZGROZXdQYXNzZW5nZXIgPSBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgdmFyIG5hbWUgPSBfYS5uYW1lLCBpbml0aWFsRmxvb3IgPSBfYS5pbml0aWFsRmxvb3IsIGRlc3RpbmF0aW9uRmxvb3IgPSBfYS5kZXN0aW5hdGlvbkZsb29yO1xuICAgICAgICBpZiAoaXNOYU4oaW5pdGlhbEZsb29yKSB8fCBpc05hTihkZXN0aW5hdGlvbkZsb29yKSlcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBwYXNzZW5nZXJzIHBhcmFtZXRlcnMnKTtcbiAgICAgICAgaWYgKGluaXRpYWxGbG9vciA9PT0gZGVzdGluYXRpb25GbG9vcilcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUGFzc2VuZ2VyIGlzIGFscmVhZHkgb24gdGhlIGRlc3RpbmF0aW9uIGZsb29yJyk7XG4gICAgICAgIHZhciBwYXNzZW5nZXIgPSB7XG4gICAgICAgICAgICBpZDogdXRpbF8xLmdlbmVyYXRlVW5pcXVlSWQoKSxcbiAgICAgICAgICAgIGRpcmVjdGlvbjogZGVzdGluYXRpb25GbG9vciA8IGluaXRpYWxGbG9vciA/IEVsZXZhdG9yRGlyZWN0aW9uLkdvaW5nRG93biA6IEVsZXZhdG9yRGlyZWN0aW9uLkdvaW5nVXAsXG4gICAgICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICAgICAgaW5pdGlhbEZsb29yOiBpbml0aWFsRmxvb3IsXG4gICAgICAgICAgICBkZXN0aW5hdGlvbkZsb29yOiBkZXN0aW5hdGlvbkZsb29yLFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLndhaXRpbmdQYXNzZW5nZXJzLnVuc2hpZnQocGFzc2VuZ2VyKTtcbiAgICAgICAgdGhpcy5lbWl0KCd3YWl0aW5nLXBhc3Nlbmdlci1hZGRlZCcsIHBhc3Nlbmdlcik7XG4gICAgfTtcbiAgICBFbGV2YXRvclN5c3RlbS5wcm90b3R5cGUuY29tbWl0TmV4dFN0ZXAgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBlXzEsIF9hLCBlXzIsIF9iLCBlXzMsIF9jLCBlXzQsIF9kLCBlXzUsIF9lO1xuICAgICAgICB2YXIgY2hhbmdlZEVsZXZhdG9ySWRzID0gbmV3IFNldCgpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgZm9yICh2YXIgX2YgPSBfX3ZhbHVlcyh0aGlzLmVsZXZhdG9ycy52YWx1ZXMoKSksIF9nID0gX2YubmV4dCgpOyAhX2cuZG9uZTsgX2cgPSBfZi5uZXh0KCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgZWxldmF0b3IgPSBfZy52YWx1ZTtcbiAgICAgICAgICAgICAgICBpZiAoZWxldmF0b3IuZGlyZWN0aW9uICE9PSBFbGV2YXRvckRpcmVjdGlvbi5TdGFuZGluZykge1xuICAgICAgICAgICAgICAgICAgICAvLyBtb3ZlIHRoZSBlbGV2YXRvclxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VkRWxldmF0b3JJZHMuYWRkKGVsZXZhdG9yLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgZWxldmF0b3IuY3VycmVudEZsb29yICs9IGVsZXZhdG9yLmRpcmVjdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgLy8gZHJvcCBwYXNzZW5nZXJzIHRoYXQgd2FudHMgdG8gYmUgb24gdGhpcyBmbG9vclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gZWxldmF0b3IucGFzc2VuZ2Vycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhc3NlbmdlciA9IGVsZXZhdG9yLnBhc3NlbmdlcnNbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFzc2VuZ2VyLmRlc3RpbmF0aW9uRmxvb3IgPT09IGVsZXZhdG9yLmN1cnJlbnRGbG9vcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZXZhdG9yLnBhc3NlbmdlcnMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdCgncGFzc2VuZ2VyLWRyb3BwZWQnLCB7IHBhc3NlbmdlcjogcGFzc2VuZ2VyLCBlbGV2YXRvcjogZWxldmF0b3IgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhlIGVsZXZhdG9yIGlzIGF0IHRoZSBsaW1pdCBmbG9vciB0aGlzIG1lYW5zIGl0IG5lZWRzIHRvIGNoYW5nZSB0aGUgZGlyZWN0aW9uXG4gICAgICAgICAgICAgICAgICAgIGlmIChlbGV2YXRvci5uZXh0RGlyZWN0aW9uICE9PSBFbGV2YXRvckRpcmVjdGlvbi5TdGFuZGluZyAmJiBlbGV2YXRvci5jdXJyZW50Rmxvb3IgPT09IGVsZXZhdG9yLmRlc3RpbmF0aW9uTGltaXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsZXZhdG9yLmRpcmVjdGlvbiA9IGVsZXZhdG9yLm5leHREaXJlY3Rpb247XG4gICAgICAgICAgICAgICAgICAgICAgICBlbGV2YXRvci5uZXh0RGlyZWN0aW9uID0gRWxldmF0b3JEaXJlY3Rpb24uU3RhbmRpbmc7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbGV2YXRvci5kZXN0aW5hdGlvbkxpbWl0ID0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIgKiBlbGV2YXRvci5kaXJlY3Rpb247XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoZWxldmF0b3IucGFzc2VuZ2Vycy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbGV2YXRvci5uZXh0RGlyZWN0aW9uICE9PSBFbGV2YXRvckRpcmVjdGlvbi5TdGFuZGluZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGV2ZW4gdGhvdWggdGhpcyBlbGV2YXRvciBpcyBlbXB0eSBpdCBuZWVkcyB0byBnbyB0aGlzIHdheSBhbnl3YXlcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGxvb2tzIGxpa2UgdGhpcyBlbGV2YXRvciBpcyBlbXB0eSBub3csIGNoZWNrIGlmIHRoZXJlIGlzIGFueSBwYXNzZW5nZXIgaW4gdGhpcyB3YXkgdGhhdCB3YW50cyB0byBnbyB0aGlzIHdheVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpc1NvbWVvbmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG1wID0gZWxldmF0b3IuY3VycmVudEZsb29yICogZWxldmF0b3IuZGlyZWN0aW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9oID0gKGVfMiA9IHZvaWQgMCwgX192YWx1ZXModGhpcy53YWl0aW5nUGFzc2VuZ2VycykpLCBfaiA9IF9oLm5leHQoKTsgIV9qLmRvbmU7IF9qID0gX2gubmV4dCgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFzc2VuZ2VyID0gX2oudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFzc2VuZ2VyLmluaXRpYWxGbG9vciAqIGVsZXZhdG9yLmRpcmVjdGlvbiA+PSB0bXAgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzZW5nZXIuZGlyZWN0aW9uID09PSBlbGV2YXRvci5kaXJlY3Rpb24gJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzZW5nZXIuZGVzdGluYXRpb25GbG9vciAqIGVsZXZhdG9yLmRpcmVjdGlvbiA8PSBlbGV2YXRvci5kZXN0aW5hdGlvbkxpbWl0ICogZWxldmF0b3IuZGlyZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNTb21lb25lID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZV8yXzEpIHsgZV8yID0geyBlcnJvcjogZV8yXzEgfTsgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9qICYmICFfai5kb25lICYmIChfYiA9IF9oW1wicmV0dXJuXCJdKSkgX2IuY2FsbChfaCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzIpIHRocm93IGVfMi5lcnJvcjsgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzU29tZW9uZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2lmIG5vdCB0aGVuIHN3aXRjaCBkaXJlY3Rpb24gdG8gc3RhbmRpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxldmF0b3IuZGlyZWN0aW9uID0gRWxldmF0b3JEaXJlY3Rpb24uU3RhbmRpbmc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIHRha2UgcGFzc2VuZ2VycyB0aGF0IHdhbnQgdG8gZ28gdGhpcyB3YXkgYW5kIGFyZSBvbiB0aGlzIGZsb29yIGFuZCB0aGV5IGFyZSB3aXRoaW4gdGhlIGxpbWl0XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSB0aGlzLndhaXRpbmdQYXNzZW5nZXJzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFzc2VuZ2VyID0gdGhpcy53YWl0aW5nUGFzc2VuZ2Vyc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXNzZW5nZXIuaW5pdGlhbEZsb29yID09PSBlbGV2YXRvci5jdXJyZW50Rmxvb3IgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzZW5nZXIuZGlyZWN0aW9uID09PSBlbGV2YXRvci5kaXJlY3Rpb24gJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzZW5nZXIuZGVzdGluYXRpb25GbG9vciAqIGVsZXZhdG9yLmRpcmVjdGlvbiA8IGVsZXZhdG9yLmRlc3RpbmF0aW9uTGltaXQgKiBlbGV2YXRvci5kaXJlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGV2YXRvci5wYXNzZW5nZXJzLnB1c2gocGFzc2VuZ2VyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLndhaXRpbmdQYXNzZW5nZXJzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVtaXQoJ3Bhc3Nlbmdlci10YWtlbicsIHsgcGFzc2VuZ2VyOiBwYXNzZW5nZXIsIGVsZXZhdG9yOiBlbGV2YXRvciB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfVxuICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgaWYgKF9nICYmICFfZy5kb25lICYmIChfYSA9IF9mW1wicmV0dXJuXCJdKSkgX2EuY2FsbChfZik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9XG4gICAgICAgIH1cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGZvciAodmFyIF9rID0gX192YWx1ZXModGhpcy5lbGV2YXRvcnMudmFsdWVzKCkpLCBfbCA9IF9rLm5leHQoKTsgIV9sLmRvbmU7IF9sID0gX2submV4dCgpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGVsZXZhdG9yID0gX2wudmFsdWU7XG4gICAgICAgICAgICAgICAgaWYgKGVsZXZhdG9yLmRpcmVjdGlvbiA9PSBFbGV2YXRvckRpcmVjdGlvbi5TdGFuZGluZykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgX2xvb3BfMSA9IGZ1bmN0aW9uIChwYXNzZW5nZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlXzYsIF9wO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlcmUgaXMgYW55IGVsZXZhdG9yIGdvaW5nIHRvIHRoYXQgcGVyc2lvbiwgb3Igd2lsbCB0YWtlIGl0IGluIHRoZSBuZWFyIGZ1dHVyZVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlzQW55ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9xID0gKGVfNiA9IHZvaWQgMCwgX192YWx1ZXModGhpc18xLmVsZXZhdG9ycy52YWx1ZXMoKSkpLCBfciA9IF9xLm5leHQoKTsgIV9yLmRvbmU7IF9yID0gX3EubmV4dCgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvdGhlckVsZXZhdG9yID0gX3IudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgob3RoZXJFbGV2YXRvci5kaXJlY3Rpb24gIT09IEVsZXZhdG9yRGlyZWN0aW9uLlN0YW5kaW5nICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzZW5nZXIuaW5pdGlhbEZsb29yICogb3RoZXJFbGV2YXRvci5kaXJlY3Rpb24gPiBvdGhlckVsZXZhdG9yLmN1cnJlbnRGbG9vciAqIG90aGVyRWxldmF0b3IuZGlyZWN0aW9uICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzZW5nZXIuZGVzdGluYXRpb25GbG9vciAqIGVsZXZhdG9yLmRpcmVjdGlvbiA8PVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG90aGVyRWxldmF0b3IuZGVzdGluYXRpb25MaW1pdCAqIG90aGVyRWxldmF0b3IuZGlyZWN0aW9uICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzZW5nZXIuZGlyZWN0aW9uID09PSBvdGhlckVsZXZhdG9yLmRpcmVjdGlvbikgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChvdGhlckVsZXZhdG9yLmRpcmVjdGlvbiAhPT0gRWxldmF0b3JEaXJlY3Rpb24uU3RhbmRpbmcgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdGhlckVsZXZhdG9yLm5leHREaXJlY3Rpb24gIT09IEVsZXZhdG9yRGlyZWN0aW9uLlN0YW5kaW5nICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzc2VuZ2VyLmluaXRpYWxGbG9vciAqIG90aGVyRWxldmF0b3IuZGlyZWN0aW9uIDw9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG90aGVyRWxldmF0b3IuZGVzdGluYXRpb25MaW1pdCAqIG90aGVyRWxldmF0b3IuZGlyZWN0aW9uICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzc2VuZ2VyLmRpcmVjdGlvbiA9PT0gb3RoZXJFbGV2YXRvci5uZXh0RGlyZWN0aW9uKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNBbnkgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZV82XzEpIHsgZV82ID0geyBlcnJvcjogZV82XzEgfTsgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9yICYmICFfci5kb25lICYmIChfcCA9IF9xW1wicmV0dXJuXCJdKSkgX3AuY2FsbChfcSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV82KSB0aHJvdyBlXzYuZXJyb3I7IH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNBbnkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGVyZSBhcmUgbm9uZSwgdGhlbiBtYWtlIHRoaXMgZWxldmF0b3IgZ28gZm9yIHRoYXQgcGVyc29uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxldmF0b3IuZGlyZWN0aW9uID0gTWF0aC5zaWduKHBhc3Nlbmdlci5pbml0aWFsRmxvb3IgLSBlbGV2YXRvci5jdXJyZW50Rmxvb3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbGV2YXRvci5kaXJlY3Rpb24gPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaW4gY2FzZSB0aGUgcGFzc2VuZ2VyIGlzIG9uZSB0aGUgc2FtZSBmbG9vciBhcyB0aGUgZWxldmF0b3IsIHRha2UgaXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxldmF0b3IuZGlyZWN0aW9uID0gTWF0aC5zaWduKHBhc3Nlbmdlci5kZXN0aW5hdGlvbkZsb29yIC0gcGFzc2VuZ2VyLmluaXRpYWxGbG9vcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSB0aGlzXzEud2FpdGluZ1Bhc3NlbmdlcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXNzZW5nZXJfMSA9IHRoaXNfMS53YWl0aW5nUGFzc2VuZ2Vyc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXNzZW5nZXJfMS5pbml0aWFsRmxvb3IgPT09IGVsZXZhdG9yLmN1cnJlbnRGbG9vciAmJiBwYXNzZW5nZXJfMS5kaXJlY3Rpb24gPT09IGVsZXZhdG9yLmRpcmVjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZXZhdG9yLnBhc3NlbmdlcnMucHVzaChwYXNzZW5nZXJfMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc18xLndhaXRpbmdQYXNzZW5nZXJzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzXzEuZW1pdCgncGFzc2VuZ2VyLXRha2VuJywgeyBwYXNzZW5nZXI6IHBhc3Nlbmdlcl8xLCBlbGV2YXRvcjogZWxldmF0b3IgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxldmF0b3IubmV4dERpcmVjdGlvbiA9IE1hdGguc2lnbihwYXNzZW5nZXIuZGVzdGluYXRpb25GbG9vciAtIHBhc3Nlbmdlci5pbml0aWFsRmxvb3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbGV2YXRvci5uZXh0RGlyZWN0aW9uID09PSBlbGV2YXRvci5kaXJlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxldmF0b3IubmV4dERpcmVjdGlvbiA9IEVsZXZhdG9yRGlyZWN0aW9uLlN0YW5kaW5nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGV2YXRvci5kZXN0aW5hdGlvbkxpbWl0ID0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIgKiBlbGV2YXRvci5kaXJlY3Rpb247XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpdCdzIGdvb2QgaWRlYSB0byBmaW5kIGEgcGVyc29uIHRoYXQgaXMgb24gbG93ZXN0L2hlaWdoZXN0IGZsb29yXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsaW1pdF8xID0gcGFzc2VuZ2VyLmluaXRpYWxGbG9vcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc18xLndhaXRpbmdQYXNzZW5nZXJzLmZvckVhY2goZWxldmF0b3IuZGlyZWN0aW9uID09PSBFbGV2YXRvckRpcmVjdGlvbi5Hb2luZ1VwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGZ1bmN0aW9uIChwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHAuaW5pdGlhbEZsb29yID4gbGltaXRfMSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGltaXRfMSA9IHAuaW5pdGlhbEZsb29yO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBmdW5jdGlvbiAocCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwLmluaXRpYWxGbG9vciA8IGxpbWl0XzEpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbWl0XzEgPSBwLmluaXRpYWxGbG9vcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGV2YXRvci5kZXN0aW5hdGlvbkxpbWl0ID0gbGltaXRfMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlZEVsZXZhdG9ySWRzLmFkZChlbGV2YXRvci5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiYnJlYWtcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRoaXNfMSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBmaW5kIGEgZGlyZWN0aW9uIHRvIGdvIHRvXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBfbSA9IChlXzQgPSB2b2lkIDAsIF9fdmFsdWVzKHRoaXMud2FpdGluZ1Bhc3NlbmdlcnMpKSwgX28gPSBfbS5uZXh0KCk7ICFfby5kb25lOyBfbyA9IF9tLm5leHQoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXNzZW5nZXIgPSBfby52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RhdGVfMSA9IF9sb29wXzEocGFzc2VuZ2VyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGVfMSA9PT0gXCJicmVha1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZV80XzEpIHsgZV80ID0geyBlcnJvcjogZV80XzEgfTsgfVxuICAgICAgICAgICAgICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9vICYmICFfby5kb25lICYmIChfZCA9IF9tW1wicmV0dXJuXCJdKSkgX2QuY2FsbChfbSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfNCkgdGhyb3cgZV80LmVycm9yOyB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVfM18xKSB7IGVfMyA9IHsgZXJyb3I6IGVfM18xIH07IH1cbiAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGlmIChfbCAmJiAhX2wuZG9uZSAmJiAoX2MgPSBfa1tcInJldHVyblwiXSkpIF9jLmNhbGwoX2spO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzMpIHRocm93IGVfMy5lcnJvcjsgfVxuICAgICAgICB9XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBmb3IgKHZhciBjaGFuZ2VkRWxldmF0b3JJZHNfMSA9IF9fdmFsdWVzKGNoYW5nZWRFbGV2YXRvcklkcyksIGNoYW5nZWRFbGV2YXRvcklkc18xXzEgPSBjaGFuZ2VkRWxldmF0b3JJZHNfMS5uZXh0KCk7ICFjaGFuZ2VkRWxldmF0b3JJZHNfMV8xLmRvbmU7IGNoYW5nZWRFbGV2YXRvcklkc18xXzEgPSBjaGFuZ2VkRWxldmF0b3JJZHNfMS5uZXh0KCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgaWQgPSBjaGFuZ2VkRWxldmF0b3JJZHNfMV8xLnZhbHVlO1xuICAgICAgICAgICAgICAgIHRoaXMuZW1pdCgnZWxldmF0b3ItdXBkYXRlZCcsIHRoaXMuZWxldmF0b3JzLmdldChpZCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlXzVfMSkgeyBlXzUgPSB7IGVycm9yOiBlXzVfMSB9OyB9XG4gICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBpZiAoY2hhbmdlZEVsZXZhdG9ySWRzXzFfMSAmJiAhY2hhbmdlZEVsZXZhdG9ySWRzXzFfMS5kb25lICYmIChfZSA9IGNoYW5nZWRFbGV2YXRvcklkc18xW1wicmV0dXJuXCJdKSkgX2UuY2FsbChjaGFuZ2VkRWxldmF0b3JJZHNfMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfNSkgdGhyb3cgZV81LmVycm9yOyB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBFbGV2YXRvclN5c3RlbTtcbn0oZXZlbnRfcHJvZHVjZXJfMVtcImRlZmF1bHRcIl0pKTtcbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gRWxldmF0b3JTeXN0ZW07XG4iLCJcInVzZSBzdHJpY3RcIjtcbnZhciBfX3ZhbHVlcyA9ICh0aGlzICYmIHRoaXMuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHtcbiAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwO1xuICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pO1xuICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gXCJudW1iZXJcIikgcmV0dXJuIHtcbiAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDtcbiAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gXCJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLlwiIDogXCJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xufTtcbmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG52YXIgRXZlbnRQcm9kdWNlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBFdmVudFByb2R1Y2VyKCkge1xuICAgICAgICB0aGlzLmxpc3RlbmVycyA9IG5ldyBNYXAoKTtcbiAgICB9XG4gICAgRXZlbnRQcm9kdWNlci5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uICh0eXBlLCBsaXN0ZW5lcikge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHZhciBsaXN0ID0gKF9hID0gdGhpcy5saXN0ZW5lcnMuZ2V0KHR5cGUpKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiBbXTtcbiAgICAgICAgbGlzdC5wdXNoKGxpc3RlbmVyKTtcbiAgICAgICAgdGhpcy5saXN0ZW5lcnMuc2V0KHR5cGUsIGxpc3QpO1xuICAgIH07XG4gICAgRXZlbnRQcm9kdWNlci5wcm90b3R5cGUuZW1pdCA9IGZ1bmN0aW9uICh0eXBlLCBldmVudCkge1xuICAgICAgICB2YXIgZV8xLCBfYTtcbiAgICAgICAgdmFyIF9iO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgZm9yICh2YXIgX2MgPSBfX3ZhbHVlcygoKF9iID0gdGhpcy5saXN0ZW5lcnMuZ2V0KHR5cGUpKSAhPT0gbnVsbCAmJiBfYiAhPT0gdm9pZCAwID8gX2IgOiBbXSkpLCBfZCA9IF9jLm5leHQoKTsgIV9kLmRvbmU7IF9kID0gX2MubmV4dCgpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGwgPSBfZC52YWx1ZTtcbiAgICAgICAgICAgICAgICBsKGV2ZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfVxuICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgaWYgKF9kICYmICFfZC5kb25lICYmIChfYSA9IF9jW1wicmV0dXJuXCJdKSkgX2EuY2FsbChfYyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBFdmVudFByb2R1Y2VyO1xufSgpKTtcbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gRXZlbnRQcm9kdWNlcjtcbiIsIlwidXNlIHN0cmljdFwiO1xuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcbmV4cG9ydHMuZ2VuZXJhdGVVbmlxdWVJZCA9IHZvaWQgMDtcbnZhciBuZXh0SWQgPSAxO1xudmFyIGdlbmVyYXRlVW5pcXVlSWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIG5leHRJZCsrO1xufTtcbmV4cG9ydHMuZ2VuZXJhdGVVbmlxdWVJZCA9IGdlbmVyYXRlVW5pcXVlSWQ7XG4iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xudmFyIGVsZXZhdG9yX3N5c3RlbV8xID0gcmVxdWlyZShcIi4vZWxldmF0b3Itc3lzdGVtXCIpO1xuLy8gc2hvdyBtYWluIGJveCB3aGVuIEpTIGlzIGVuYWJsZWRcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ21haW4nKS5zdHlsZS5kaXNwbGF5ID0gbnVsbDtcbnZhciBzeXN0ZW0gPSBuZXcgZWxldmF0b3Jfc3lzdGVtXzFbXCJkZWZhdWx0XCJdKCk7XG4vLyB3aW5kb3cuc3lzdGVtID0gc3lzdGVtXG52YXIgZWxldmF0b3JzTGlzdERpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlbGV2YXRvcnMtbGlzdCcpO1xudmFyIHdhaXRpbmdQYXNzZW5nZXJzTGlzdERpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3YWl0aW5nLXBhc3NlbmdlcnMtbGlzdCcpO1xudmFyIGZvcm1hdERpcmVjdGlvbiA9IGZ1bmN0aW9uIChkaXIpIHtcbiAgICBzd2l0Y2ggKGRpcikge1xuICAgICAgICBjYXNlIGVsZXZhdG9yX3N5c3RlbV8xLkVsZXZhdG9yRGlyZWN0aW9uLkdvaW5nVXA6XG4gICAgICAgICAgICByZXR1cm4gJ3VwJztcbiAgICAgICAgY2FzZSBlbGV2YXRvcl9zeXN0ZW1fMS5FbGV2YXRvckRpcmVjdGlvbi5Hb2luZ0Rvd246XG4gICAgICAgICAgICByZXR1cm4gJ2Rvd24nO1xuICAgICAgICBjYXNlIGVsZXZhdG9yX3N5c3RlbV8xLkVsZXZhdG9yRGlyZWN0aW9uLlN0YW5kaW5nOlxuICAgICAgICAgICAgcmV0dXJuICdub25lJztcbiAgICB9XG59O1xuLy8gRE9NIGV2ZW50czpcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhZGQtZWxldmF0b3ItYnRuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgc3lzdGVtLmFkZE5ld0VsZXZhdG9yKCtwcm9tcHQoJ1doYXQgZmxvb3IgaXMgdGhhdCBlbGV2YXRvciBpbml0aWFsbHkgb24/JykpO1xufSk7XG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYWRkLXBhc3Nlbmdlci1idG4nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICBzeXN0ZW0uYWRkTmV3UGFzc2VuZ2VyKHtcbiAgICAgICAgbmFtZTogcHJvbXB0KCdHaXZlIGEgcGFzc2VuZ2VyIG5hbWUnLCAnJykgfHwgJycsXG4gICAgICAgIGluaXRpYWxGbG9vcjogK3Byb21wdCgnVGhhdCBmbG9vciBpcyB0aGF0IHBhc3NlbmdlciBvbj8nKSxcbiAgICAgICAgZGVzdGluYXRpb25GbG9vcjogK3Byb21wdCgnVGhhdCBmbG9vciBpcyB0aGF0IHBhc3NlbmdlciBnb2luZyB0byBnbz8nKSxcbiAgICB9KTtcbn0pO1xuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25leHQtc3RlcC1idG4nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHN5c3RlbS5jb21taXROZXh0U3RlcCgpOyB9KTtcbi8vIHN5c3RlbSBldmVudHNcbnN5c3RlbS5hZGRFdmVudExpc3RlbmVyKCdlbGV2YXRvci1hZGRlZCcsIGZ1bmN0aW9uIChlbGV2YXRvcikge1xuICAgIHZhciBlbGV2YXRvckRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGVsZXZhdG9yRGl2LmlkID0gXCJlbGV2YXRvci1pZC1cIiArIGVsZXZhdG9yLmlkO1xuICAgIGVsZXZhdG9yRGl2LmNsYXNzTGlzdC5hZGQoJ2VsZXZhdG9yJyk7XG4gICAgLy8gICB7XG4gICAgLy8gICAgIGNvbnN0IGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAvLyAgICAgZWwuY2xhc3NMaXN0LmFkZChcImVsZXZhdG9yLWlkLXZhbHVlXCIpO1xuICAgIC8vICAgICBlbC5pbm5lclRleHQgPSBgJHtlbGV2YXRvci5pZH1gO1xuICAgIC8vICAgICBlbGV2YXRvckRpdi5hcHBlbmRDaGlsZChlbCk7XG4gICAgLy8gICB9XG4gICAgLy8gICB7XG4gICAgLy8gICAgIGNvbnN0IGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAvLyAgICAgZWwuY2xhc3NMaXN0LmFkZChcImVsZXZhdG9yLWlkLXRpdGxlXCIpO1xuICAgIC8vICAgICBlbC5pbm5lclRleHQgPSBgRWxldmF0b3IgSURgO1xuICAgIC8vICAgICBlbGV2YXRvckRpdi5hcHBlbmRDaGlsZChlbCk7XG4gICAgLy8gICB9XG4gICAge1xuICAgICAgICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgZWwuY2xhc3NMaXN0LmFkZCgnY3VycmVudC1mbG9vci12YWx1ZScpO1xuICAgICAgICBlbC5pbm5lclRleHQgPSBcIlwiICsgZWxldmF0b3IuY3VycmVudEZsb29yO1xuICAgICAgICBlbGV2YXRvckRpdi5hcHBlbmRDaGlsZChlbCk7XG4gICAgfVxuICAgIHtcbiAgICAgICAgdmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGVsLmlubmVyVGV4dCA9IFwiQ3VycmVudCBmbG9vclwiO1xuICAgICAgICBlbGV2YXRvckRpdi5hcHBlbmRDaGlsZChlbCk7XG4gICAgfVxuICAgIHtcbiAgICAgICAgdmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGVsLmNsYXNzTGlzdC5hZGQoJ2RpcmVjdGlvbi12YWx1ZScpO1xuICAgICAgICBlbC5pbm5lclRleHQgPSBcIlwiICsgZm9ybWF0RGlyZWN0aW9uKGVsZXZhdG9yLmRpcmVjdGlvbik7XG4gICAgICAgIGVsZXZhdG9yRGl2LmFwcGVuZENoaWxkKGVsKTtcbiAgICB9XG4gICAge1xuICAgICAgICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgZWwuaW5uZXJUZXh0ID0gXCJEaXJlY3Rpb25cIjtcbiAgICAgICAgZWxldmF0b3JEaXYuYXBwZW5kQ2hpbGQoZWwpO1xuICAgIH1cbiAgICAvLyB7XG4gICAgLy8gICAgIGNvbnN0IGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICAvLyAgICAgZWwuY2xhc3NMaXN0LmFkZCgnbGltaXQtZmxvb3ItdmFsdWUnKVxuICAgIC8vICAgICBlbC5pbm5lclRleHQgPSBgJHtlbGV2YXRvci5kZXN0aW5hdGlvbkxpbWl0fWBcbiAgICAvLyAgICAgZWxldmF0b3JEaXYuYXBwZW5kQ2hpbGQoZWwpXG4gICAgLy8gfVxuICAgIC8vIHtcbiAgICAvLyAgICAgY29uc3QgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIC8vICAgICBlbC5pbm5lclRleHQgPSBgRmxvb3IgbGltaXRgXG4gICAgLy8gICAgIGVsZXZhdG9yRGl2LmFwcGVuZENoaWxkKGVsKVxuICAgIC8vIH1cbiAgICAvLyB7XG4gICAgLy8gICAgIGNvbnN0IGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICAvLyAgICAgZWwuY2xhc3NMaXN0LmFkZCgnbmV4dC1kaXJlY3Rpb24tdmFsdWUnKVxuICAgIC8vICAgICBlbC5pbm5lclRleHQgPSBgJHtmb3JtYXREaXJlY3Rpb24oZWxldmF0b3IubmV4dERpcmVjdGlvbil9YFxuICAgIC8vICAgICBlbGV2YXRvckRpdi5hcHBlbmRDaGlsZChlbClcbiAgICAvLyB9XG4gICAgLy8ge1xuICAgIC8vICAgICBjb25zdCBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgLy8gICAgIGVsLmlubmVyVGV4dCA9IGBOZXh0IGRpcmVjdGlvbmBcbiAgICAvLyAgICAgZWxldmF0b3JEaXYuYXBwZW5kQ2hpbGQoZWwpXG4gICAgLy8gfVxuICAgIHtcbiAgICAgICAgdmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGVsLmNsYXNzTGlzdC5hZGQoJ3Bhc3NlbmdlcnMtaW5zaWRlLWxpc3QnKTtcbiAgICAgICAgZWxldmF0b3JEaXYuYXBwZW5kQ2hpbGQoZWwpO1xuICAgIH1cbiAgICBlbGV2YXRvcnNMaXN0RGl2LmFwcGVuZENoaWxkKGVsZXZhdG9yRGl2KTtcbn0pO1xuc3lzdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2VsZXZhdG9yLXVwZGF0ZWQnLCBmdW5jdGlvbiAoZWxldmF0b3IpIHtcbiAgICB2YXIgZWxldmF0b3JEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImVsZXZhdG9yLWlkLVwiICsgZWxldmF0b3IuaWQpO1xuICAgIGVsZXZhdG9yRGl2LnF1ZXJ5U2VsZWN0b3IoJy5jdXJyZW50LWZsb29yLXZhbHVlJykuaW5uZXJUZXh0ID0gXCJcIiArIGVsZXZhdG9yLmN1cnJlbnRGbG9vcjtcbiAgICBlbGV2YXRvckRpdi5xdWVyeVNlbGVjdG9yKCcuZGlyZWN0aW9uLXZhbHVlJykuaW5uZXJUZXh0ID0gXCJcIiArIGZvcm1hdERpcmVjdGlvbihlbGV2YXRvci5kaXJlY3Rpb24pO1xuICAgIC8vIChlbGV2YXRvckRpdi5xdWVyeVNlbGVjdG9yKCcubGltaXQtZmxvb3ItdmFsdWUnKSBhcyBIVE1MRGl2RWxlbWVudCkuaW5uZXJUZXh0ID0gYCR7ZWxldmF0b3IuZGVzdGluYXRpb25MaW1pdH1gO1xuICAgIC8vIChlbGV2YXRvckRpdi5xdWVyeVNlbGVjdG9yKCcubmV4dC1kaXJlY3Rpb24tdmFsdWUnKSBhcyBIVE1MRGl2RWxlbWVudCkuaW5uZXJUZXh0ID0gYCR7Zm9ybWF0RGlyZWN0aW9uKGVsZXZhdG9yLm5leHREaXJlY3Rpb24pfWA7XG59KTtcbnN5c3RlbS5hZGRFdmVudExpc3RlbmVyKCd3YWl0aW5nLXBhc3Nlbmdlci1hZGRlZCcsIGZ1bmN0aW9uIChwYXNzZW5nZXIpIHtcbiAgICB2YXIgZWxldmF0b3JEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBlbGV2YXRvckRpdi5pZCA9IFwid2FpdGluZy1wYXNzZW5nZXItaWQtXCIgKyBwYXNzZW5nZXIuaWQ7XG4gICAgZWxldmF0b3JEaXYuY2xhc3NMaXN0LmFkZCgnd2FpdGluZy1wYXNzZW5nZXInKTtcbiAgICB7XG4gICAgICAgIHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBlbC5pbm5lclRleHQgPSBcIlwiICsgcGFzc2VuZ2VyLm5hbWU7XG4gICAgICAgIGVsZXZhdG9yRGl2LmFwcGVuZENoaWxkKGVsKTtcbiAgICB9XG4gICAge1xuICAgICAgICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgZWwuaW5uZXJUZXh0ID0gXCJOYW1lXCI7XG4gICAgICAgIGVsZXZhdG9yRGl2LmFwcGVuZENoaWxkKGVsKTtcbiAgICB9XG4gICAge1xuICAgICAgICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgZWwuaW5uZXJUZXh0ID0gXCJcIiArIHBhc3Nlbmdlci5pbml0aWFsRmxvb3I7XG4gICAgICAgIGVsZXZhdG9yRGl2LmFwcGVuZENoaWxkKGVsKTtcbiAgICB9XG4gICAge1xuICAgICAgICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgZWwuaW5uZXJUZXh0ID0gXCJXYWl0aW5nIGF0XCI7XG4gICAgICAgIGVsZXZhdG9yRGl2LmFwcGVuZENoaWxkKGVsKTtcbiAgICB9XG4gICAge1xuICAgICAgICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgZWwuaW5uZXJUZXh0ID0gXCJcIiArIHBhc3Nlbmdlci5kZXN0aW5hdGlvbkZsb29yO1xuICAgICAgICBlbGV2YXRvckRpdi5hcHBlbmRDaGlsZChlbCk7XG4gICAgfVxuICAgIHtcbiAgICAgICAgdmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGVsLmlubmVyVGV4dCA9IFwiRGVzdGluYXRpb24gZmxvb3JcIjtcbiAgICAgICAgZWxldmF0b3JEaXYuYXBwZW5kQ2hpbGQoZWwpO1xuICAgIH1cbiAgICB3YWl0aW5nUGFzc2VuZ2Vyc0xpc3REaXYuYXBwZW5kQ2hpbGQoZWxldmF0b3JEaXYpO1xufSk7XG5zeXN0ZW0uYWRkRXZlbnRMaXN0ZW5lcigncGFzc2VuZ2VyLXRha2VuJywgZnVuY3Rpb24gKF9hKSB7XG4gICAgdmFyIHBhc3NlbmdlciA9IF9hLnBhc3NlbmdlciwgZWxldmF0b3IgPSBfYS5lbGV2YXRvcjtcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIndhaXRpbmctcGFzc2VuZ2VyLWlkLVwiICsgcGFzc2VuZ2VyLmlkKS5yZW1vdmUoKTtcbiAgICB2YXIgbGlzdE9mSW5zaWRlcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VsZXZhdG9yLWlkLVwiICsgZWxldmF0b3IuaWQgKyBcIiAucGFzc2VuZ2Vycy1pbnNpZGUtbGlzdFwiKTtcbiAgICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBlbC5pZCA9IFwicGFzc2VuZ2VyX1wiICsgcGFzc2VuZ2VyLmlkO1xuICAgIGVsLmNsYXNzTGlzdC5hZGQoJ3Bhc3Nlbmdlci1pbnNpZGUnKTtcbiAgICBlbC5pbm5lclRleHQgPSBwYXNzZW5nZXIubmFtZSArIFwiIChcIiArIHBhc3Nlbmdlci5kZXN0aW5hdGlvbkZsb29yICsgXCIpXCI7XG4gICAgbGlzdE9mSW5zaWRlcnMuYXBwZW5kQ2hpbGQoZWwpO1xufSk7XG5zeXN0ZW0uYWRkRXZlbnRMaXN0ZW5lcigncGFzc2VuZ2VyLWRyb3BwZWQnLCBmdW5jdGlvbiAoX2EpIHtcbiAgICB2YXIgcGFzc2VuZ2VyID0gX2EucGFzc2VuZ2VyLCBlbGV2YXRvciA9IF9hLmVsZXZhdG9yO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWxldmF0b3ItaWQtXCIgKyBlbGV2YXRvci5pZCArIFwiICNwYXNzZW5nZXJfXCIgKyBwYXNzZW5nZXIuaWQpLnJlbW92ZSgpO1xufSk7XG4vLyBzeXN0ZW0uYWRkTmV3RWxldmF0b3IoKVxuLy8gc3lzdGVtLmFkZE5ld1Bhc3Nlbmdlcih7XG4vLyAgICAgbmFtZTogJ0pha3ViJyxcbi8vICAgICBpbml0aWFsRmxvb3I6IDAsXG4vLyAgICAgZGVzdGluYXRpb25GbG9vcjogMSxcbi8vIH0pXG4vLyBzeXN0ZW0uYWRkTmV3RWxldmF0b3IoKTtcbi8vIHN5c3RlbS5hZGROZXdFbGV2YXRvcigpO1xuLy8gc3lzdGVtLmFkZE5ld1Bhc3Nlbmdlcih7XG4vLyAgIG5hbWU6IFwiSmFrdWJcIixcbi8vICAgaW5pdGlhbEZsb29yOiAyLFxuLy8gICBkZXN0aW5hdGlvbkZsb29yOiA0LFxuLy8gfSk7XG4vLyBzeXN0ZW0uYWRkTmV3UGFzc2VuZ2VyKHtcbi8vICAgbmFtZTogXCJQYXdlxYJcIixcbi8vICAgaW5pdGlhbEZsb29yOiA2LFxuLy8gICBkZXN0aW5hdGlvbkZsb29yOiAzLFxuLy8gfSk7XG4vLyBzeXN0ZW0uYWRkTmV3UGFzc2VuZ2VyKHtcbi8vICAgbmFtZTogXCJQaW90clwiLFxuLy8gICBpbml0aWFsRmxvb3I6IDcsXG4vLyAgIGRlc3RpbmF0aW9uRmxvb3I6IDMsXG4vLyB9KTtcbiJdLCJzb3VyY2VSb290IjoiIn0=