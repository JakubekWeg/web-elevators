(()=>{"use strict";var e={316:function(e,t,n){var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};t.__esModule=!0,t.Elevator=t.ElevatorDirection=void 0;var a,d=n(50),s=n(882);!function(e){e[e.Standing=0]="Standing",e[e.GoingUp=1]="GoingUp",e[e.GoingDown=-1]="GoingDown"}(a=t.ElevatorDirection||(t.ElevatorDirection={}));var l=function(e){this.id=e,this.currentFloor=0,this.direction=a.Standing,this.nextDirection=a.Standing,this.destinationLimit=Number.MAX_SAFE_INTEGER,this.passengers=[]};t.Elevator=l;var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.elevators=[],t.waitingPassengers=[],t}return r(t,e),t.prototype.addNewElevator=function(e){var t=s.generateUniqueId(),n=new l(t);n.currentFloor=+e||0,this.elevators.push(n),this.emit("elevator-added",n)},t.prototype.addNewPassenger=function(e){var t=e.name,n=e.initialFloor,i=e.destinationFloor;if(isNaN(n)||isNaN(i))throw new Error("Invalid passengers parameters");if(n===i)throw new Error("Passenger is already on the destination floor");var r={id:s.generateUniqueId(),direction:i<n?a.GoingDown:a.GoingUp,name:t,initialFloor:n,destinationFloor:i};this.waitingPassengers.unshift(r),this.emit("waiting-passenger-added",r)},t.prototype.commitNextStep=function(){var e,t,n,i,r,d,s,l,c,u,v=new Set;try{for(var g=o(this.elevators.values()),p=g.next();!p.done;p=g.next())if((N=p.value).direction!==a.Standing){v.add(N),N.currentFloor+=N.direction;for(var f=N.passengers.length-1;f>=0;f--)(I=N.passengers[f]).destinationFloor===N.currentFloor&&(N.passengers.splice(f,1),this.emit("passenger-dropped",{passenger:I,elevator:N}));if(N.nextDirection!==a.Standing&&N.currentFloor===N.destinationLimit)N.direction=N.nextDirection,N.nextDirection=a.Standing,N.destinationLimit=Number.MAX_SAFE_INTEGER*N.direction;else if(0===N.passengers.length)if(N.nextDirection!==a.Standing);else{var m=!1,h=N.currentFloor*N.direction;try{for(var y=(n=void 0,o(this.waitingPassengers)),E=y.next();!E.done;E=y.next())if((I=E.value).initialFloor*N.direction>=h&&I.direction===N.direction&&I.destinationFloor*N.direction<=N.destinationLimit*N.direction){m=!0;break}}catch(e){n={error:e}}finally{try{E&&!E.done&&(i=y.return)&&i.call(y)}finally{if(n)throw n.error}}m||(N.direction=a.Standing)}for(f=this.waitingPassengers.length-1;f>=0;f--)(I=this.waitingPassengers[f]).initialFloor===N.currentFloor&&I.direction===N.direction&&I.destinationFloor*N.direction<N.destinationLimit*N.direction&&(N.passengers.push(I),this.waitingPassengers.splice(f,1),this.emit("passenger-taken",{passenger:I,elevator:N}))}}catch(t){e={error:t}}finally{try{p&&!p.done&&(t=g.return)&&t.call(g)}finally{if(e)throw e.error}}try{for(var x=o(this.elevators.values()),w=x.next();!w.done;w=x.next())if((N=w.value).direction==a.Standing){var F=function(e){var t,n,i=!1;try{for(var r=(t=void 0,o(S.elevators.values())),d=r.next();!d.done;d=r.next()){var s=d.value;if(s.direction!==a.Standing&&e.initialFloor*s.direction>s.currentFloor*s.direction&&e.destinationFloor*N.direction<=s.destinationLimit*s.direction&&e.direction===s.direction||s.direction!==a.Standing&&s.nextDirection!==a.Standing&&e.initialFloor*s.direction<=s.destinationLimit*s.direction&&e.direction===s.nextDirection){i=!0;break}}}catch(e){t={error:e}}finally{try{d&&!d.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}if(!i){if(N.direction=Math.sign(e.initialFloor-N.currentFloor),0===N.direction){N.direction=Math.sign(e.destinationFloor-e.initialFloor);for(var l=S.waitingPassengers.length-1;l>=0;l--){var c=S.waitingPassengers[l];c.initialFloor===N.currentFloor&&c.direction===N.direction&&(N.passengers.push(c),S.waitingPassengers.splice(l,1),S.emit("passenger-taken",{passenger:c,elevator:N}))}}if(N.nextDirection=Math.sign(e.destinationFloor-e.initialFloor),N.nextDirection===N.direction)N.nextDirection=a.Standing,N.destinationLimit=Number.MAX_SAFE_INTEGER*N.direction;else{var u=e.initialFloor;S.waitingPassengers.forEach(N.direction===a.GoingUp?function(e){e.initialFloor>u&&(u=e.initialFloor)}:function(e){e.initialFloor<u&&(u=e.initialFloor)}),N.destinationLimit=u}return v.add(N),"break"}},S=this;try{for(var L=(s=void 0,o(this.waitingPassengers)),b=L.next();!b.done;b=L.next()){var I;if("break"===F(I=b.value))break}}catch(e){s={error:e}}finally{try{b&&!b.done&&(l=L.return)&&l.call(L)}finally{if(s)throw s.error}}}}catch(e){r={error:e}}finally{try{w&&!w.done&&(d=x.return)&&d.call(x)}finally{if(r)throw r.error}}try{for(var _=o(v),D=_.next();!D.done;D=_.next()){var N=D.value;this.emit("elevator-updated",N)}}catch(e){c={error:e}}finally{try{D&&!D.done&&(u=_.return)&&u.call(_)}finally{if(c)throw c.error}}},t}(d.default);t.default=c},50:function(e,t){var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};t.__esModule=!0;var i=function(){function e(){this.listeners=new Map}return e.prototype.addEventListener=function(e,t){var n,i=null!==(n=this.listeners.get(e))&&void 0!==n?n:[];i.push(t),this.listeners.set(e,i)},e.prototype.emit=function(e,t){var i,r,o;try{for(var a=n(null!==(o=this.listeners.get(e))&&void 0!==o?o:[]),d=a.next();!d.done;d=a.next())(0,d.value)(t)}catch(e){i={error:e}}finally{try{d&&!d.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}},e}();t.default=i},882:(e,t)=>{t.__esModule=!0,t.generateUniqueId=void 0;var n=1;t.generateUniqueId=function(){return n++}}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,n),o.exports}(()=>{var e=n(316);document.querySelector("main").style.display=null;var t=new e.default,i=document.getElementById("elevators-list"),r=document.getElementById("waiting-passengers-list"),o=function(t){switch(t){case e.ElevatorDirection.GoingUp:return"up";case e.ElevatorDirection.GoingDown:return"down";case e.ElevatorDirection.Standing:return"none"}};document.getElementById("add-elevator-btn").addEventListener("click",(function(){t.addNewElevator(+prompt("What floor is that elevator initially on?"))})),document.getElementById("add-passenger-btn").addEventListener("click",(function(){document.getElementById("add-passenger-error").classList.add("gone"),document.getElementById("add-passenger-layout").classList.remove("gone")})),document.getElementById("add-passenger-cancel-btn").addEventListener("click",(function(){document.getElementById("add-passenger-layout").classList.add("gone")})),document.getElementById("add-passenger-confirm-btn").addEventListener("click",(function(){var e,n=document.getElementById("passenger-name-input").value,i=document.getElementById("initial-floor-input").value,r=document.getElementById("destination-floor-input").value;n?!i||isNaN(+i)?e="Invalid initial floor":!r||isNaN(+r)?e="Invalid destination floor":+r==+i&&(e="Initial floor must be different then destination one"):e="Invalid passenger name";var o=document.getElementById("add-passenger-error");e?(o.classList.remove("gone"),o.innerText=e):(o.innerText="",o.classList.add("gone"),document.getElementById("add-passenger-layout").classList.add("gone"),t.addNewPassenger({destinationFloor:+r,initialFloor:+i,name:n}))})),document.getElementById("next-step-btn").addEventListener("click",(function(){return t.commitNextStep()})),t.addEventListener("elevator-added",(function(e){var t,n=document.createElement("div");n.id="elevator-id-"+e.id,n.classList.add("elevator"),(t=document.createElement("div")).classList.add("current-floor-value"),t.innerText=""+e.currentFloor,n.appendChild(t),(t=document.createElement("div")).innerText="Current floor",n.appendChild(t),(t=document.createElement("div")).classList.add("direction-value"),t.innerText=""+o(e.direction),n.appendChild(t),(t=document.createElement("div")).innerText="Direction",n.appendChild(t),(t=document.createElement("div")).classList.add("passengers-inside-list"),n.appendChild(t),i.appendChild(n)})),t.addEventListener("elevator-updated",(function(e){var t=document.getElementById("elevator-id-"+e.id);t.querySelector(".current-floor-value").innerText=""+e.currentFloor,t.querySelector(".direction-value").innerText=""+o(e.direction)})),t.addEventListener("waiting-passenger-added",(function(e){var t,n=document.createElement("div");n.id="waiting-passenger-id-"+e.id,n.classList.add("waiting-passenger"),(t=document.createElement("div")).innerText=""+e.name,n.appendChild(t),(t=document.createElement("div")).innerText="Name",n.appendChild(t),(t=document.createElement("div")).innerText=""+e.initialFloor,n.appendChild(t),(t=document.createElement("div")).innerText="Waiting at",n.appendChild(t),(t=document.createElement("div")).innerText=""+e.destinationFloor,n.appendChild(t),(t=document.createElement("div")).innerText="Destination floor",n.appendChild(t),r.appendChild(n)})),t.addEventListener("passenger-taken",(function(e){var t=e.passenger,n=e.elevator;document.getElementById("waiting-passenger-id-"+t.id).remove();var i=document.querySelector("#elevator-id-"+n.id+" .passengers-inside-list"),r=document.createElement("div");r.id="passenger_"+t.id,r.classList.add("passenger-inside"),r.innerText=t.name+" ("+t.destinationFloor+")",i.appendChild(r)})),t.addEventListener("passenger-dropped",(function(e){var t=e.passenger,n=e.elevator;document.querySelector("#elevator-id-"+n.id+" #passenger_"+t.id).remove()}))})()})();