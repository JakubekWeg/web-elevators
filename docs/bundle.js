(()=>{"use strict";var e={316:function(e,t,n){var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};t.__esModule=!0,t.Elevator=t.ElevatorDirection=void 0;var a,d=n(50),s=n(882);!function(e){e[e.Standing=0]="Standing",e[e.GoingUp=1]="GoingUp",e[e.GoingDown=-1]="GoingDown"}(a=t.ElevatorDirection||(t.ElevatorDirection={}));var l=function(e){this.id=e,this.currentFloor=0,this.direction=a.Standing,this.nextDirection=a.Standing,this.destinationLimit=Number.MAX_SAFE_INTEGER,this.passengers=[]};t.Elevator=l;var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.elevators=new Map,t.waitingPassengers=[],t}return r(t,e),t.prototype.addNewElevator=function(e){var t=s.generateUniqueId(),n=new l(t);n.currentFloor=+e||0,this.elevators.set(t,n),this.emit("elevator-added",n)},t.prototype.addNewPassenger=function(e){var t=e.name,n=e.initialFloor,i=e.destinationFloor;if(isNaN(n)||isNaN(i))throw new Error("Invalid passengers parameters");if(n===i)throw new Error("Passenger is already on the destination floor");var r={id:s.generateUniqueId(),direction:i<n?a.GoingDown:a.GoingUp,name:t,initialFloor:n,destinationFloor:i};this.waitingPassengers.unshift(r),this.emit("waiting-passenger-added",r)},t.prototype.commitNextStep=function(){var e,t,n,i,r,d,s,l,c,u,v=new Set;try{for(var p=o(this.elevators.values()),g=p.next();!g.done;g=p.next())if((F=g.value).direction!==a.Standing){v.add(F.id),F.currentFloor+=F.direction;for(var f=F.passengers.length-1;f>=0;f--)(D=F.passengers[f]).destinationFloor===F.currentFloor&&(F.passengers.splice(f,1),this.emit("passenger-dropped",{passenger:D,elevator:F}));if(F.nextDirection!==a.Standing&&F.currentFloor===F.destinationLimit)F.direction=F.nextDirection,F.nextDirection=a.Standing,F.destinationLimit=Number.MAX_SAFE_INTEGER*F.direction;else if(0===F.passengers.length)if(F.nextDirection!==a.Standing);else{var h=!1,m=F.currentFloor*F.direction;try{for(var y=(n=void 0,o(this.waitingPassengers)),E=y.next();!E.done;E=y.next())if((D=E.value).initialFloor*F.direction>=m&&D.direction===F.direction&&D.destinationFloor*F.direction<=F.destinationLimit*F.direction){h=!0;break}}catch(e){n={error:e}}finally{try{E&&!E.done&&(i=y.return)&&i.call(y)}finally{if(n)throw n.error}}h||(F.direction=a.Standing)}for(f=this.waitingPassengers.length-1;f>=0;f--)(D=this.waitingPassengers[f]).initialFloor===F.currentFloor&&D.direction===F.direction&&D.destinationFloor*F.direction<F.destinationLimit*F.direction&&(F.passengers.push(D),this.waitingPassengers.splice(f,1),this.emit("passenger-taken",{passenger:D,elevator:F}))}}catch(t){e={error:t}}finally{try{g&&!g.done&&(t=p.return)&&t.call(p)}finally{if(e)throw e.error}}try{for(var w=o(this.elevators.values()),x=w.next();!x.done;x=w.next()){var F;if((F=x.value).direction==a.Standing){var S=function(e){var t,n,i=!1;try{for(var r=(t=void 0,o(_.elevators.values())),d=r.next();!d.done;d=r.next()){var s=d.value;if(s.direction!==a.Standing&&e.initialFloor*s.direction>s.currentFloor*s.direction&&e.destinationFloor*F.direction<=s.destinationLimit*s.direction&&e.direction===s.direction||s.direction!==a.Standing&&s.nextDirection!==a.Standing&&e.initialFloor*s.direction<=s.destinationLimit*s.direction&&e.direction===s.nextDirection){i=!0;break}}}catch(e){t={error:e}}finally{try{d&&!d.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}if(!i){if(F.direction=Math.sign(e.initialFloor-F.currentFloor),0===F.direction){F.direction=Math.sign(e.destinationFloor-e.initialFloor);for(var l=_.waitingPassengers.length-1;l>=0;l--){var c=_.waitingPassengers[l];c.initialFloor===F.currentFloor&&c.direction===F.direction&&(F.passengers.push(c),_.waitingPassengers.splice(l,1),_.emit("passenger-taken",{passenger:c,elevator:F}))}}if(F.nextDirection=Math.sign(e.destinationFloor-e.initialFloor),F.nextDirection===F.direction)F.nextDirection=a.Standing,F.destinationLimit=Number.MAX_SAFE_INTEGER*F.direction;else{var u=e.initialFloor;_.waitingPassengers.forEach(F.direction===a.GoingUp?function(e){e.initialFloor>u&&(u=e.initialFloor)}:function(e){e.initialFloor<u&&(u=e.initialFloor)}),F.destinationLimit=u}return v.add(F.id),"break"}},_=this;try{for(var b=(s=void 0,o(this.waitingPassengers)),L=b.next();!L.done;L=b.next()){var D;if("break"===S(D=L.value))break}}catch(e){s={error:e}}finally{try{L&&!L.done&&(l=b.return)&&l.call(b)}finally{if(s)throw s.error}}}}}catch(e){r={error:e}}finally{try{x&&!x.done&&(d=w.return)&&d.call(w)}finally{if(r)throw r.error}}try{for(var T=o(v),N=T.next();!N.done;N=T.next()){var C=N.value;this.emit("elevator-updated",this.elevators.get(C))}}catch(e){c={error:e}}finally{try{N&&!N.done&&(u=T.return)&&u.call(T)}finally{if(c)throw c.error}}},t}(d.default);t.default=c},50:function(e,t){var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};t.__esModule=!0;var i=function(){function e(){this.listeners=new Map}return e.prototype.addEventListener=function(e,t){var n,i=null!==(n=this.listeners.get(e))&&void 0!==n?n:[];i.push(t),this.listeners.set(e,i)},e.prototype.emit=function(e,t){var i,r,o;try{for(var a=n(null!==(o=this.listeners.get(e))&&void 0!==o?o:[]),d=a.next();!d.done;d=a.next())(0,d.value)(t)}catch(e){i={error:e}}finally{try{d&&!d.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}},e}();t.default=i},882:(e,t)=>{t.__esModule=!0,t.generateUniqueId=void 0;var n=1;t.generateUniqueId=function(){return n++}}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,n),o.exports}(()=>{var e=n(316);document.querySelector("main").style.display=null;var t=new e.default,i=document.getElementById("elevators-list"),r=document.getElementById("waiting-passengers-list"),o=function(t){switch(t){case e.ElevatorDirection.GoingUp:return"up";case e.ElevatorDirection.GoingDown:return"down";case e.ElevatorDirection.Standing:return"none"}};document.getElementById("add-elevator-btn").addEventListener("click",(function(){t.addNewElevator(+prompt("What floor is that elevator initially on?"))})),document.getElementById("add-passenger-btn").addEventListener("click",(function(){t.addNewPassenger({name:prompt("Give a passenger name","")||"",initialFloor:+prompt("That floor is that passenger on?"),destinationFloor:+prompt("That floor is that passenger going to go?")})})),document.getElementById("next-step-btn").addEventListener("click",(function(){return t.commitNextStep()})),t.addEventListener("elevator-added",(function(e){var t,n=document.createElement("div");n.id="elevator-id-"+e.id,n.classList.add("elevator"),(t=document.createElement("div")).classList.add("current-floor-value"),t.innerText=""+e.currentFloor,n.appendChild(t),(t=document.createElement("div")).innerText="Current floor",n.appendChild(t),(t=document.createElement("div")).classList.add("direction-value"),t.innerText=""+o(e.direction),n.appendChild(t),(t=document.createElement("div")).innerText="Direction",n.appendChild(t),(t=document.createElement("div")).classList.add("passengers-inside-list"),n.appendChild(t),i.appendChild(n)})),t.addEventListener("elevator-updated",(function(e){var t=document.getElementById("elevator-id-"+e.id);t.querySelector(".current-floor-value").innerText=""+e.currentFloor,t.querySelector(".direction-value").innerText=""+o(e.direction)})),t.addEventListener("waiting-passenger-added",(function(e){var t,n=document.createElement("div");n.id="waiting-passenger-id-"+e.id,n.classList.add("waiting-passenger"),(t=document.createElement("div")).innerText=""+e.name,n.appendChild(t),(t=document.createElement("div")).innerText="Name",n.appendChild(t),(t=document.createElement("div")).innerText=""+e.initialFloor,n.appendChild(t),(t=document.createElement("div")).innerText="Waiting at",n.appendChild(t),(t=document.createElement("div")).innerText=""+e.destinationFloor,n.appendChild(t),(t=document.createElement("div")).innerText="Destination floor",n.appendChild(t),r.appendChild(n)})),t.addEventListener("passenger-taken",(function(e){var t=e.passenger,n=e.elevator;document.getElementById("waiting-passenger-id-"+t.id).remove();var i=document.querySelector("#elevator-id-"+n.id+" .passengers-inside-list"),r=document.createElement("div");r.id="passenger_"+t.id,r.classList.add("passenger-inside"),r.innerText=""+t.name,i.appendChild(r)})),t.addEventListener("passenger-dropped",(function(e){var t=e.passenger,n=e.elevator;document.querySelector("#elevator-id-"+n.id+" #passenger_"+t.id).remove()}))})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWItZWxldmF0b3JzLy4vc3JjL2VsZXZhdG9yLXN5c3RlbS50cyIsIndlYnBhY2s6Ly93ZWItZWxldmF0b3JzLy4vc3JjL2V2ZW50LXByb2R1Y2VyLnRzIiwid2VicGFjazovL3dlYi1lbGV2YXRvcnMvLi9zcmMvdXRpbC50cyIsIndlYnBhY2s6Ly93ZWItZWxldmF0b3JzL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3dlYi1lbGV2YXRvcnMvLi9zcmMvbWFpbi50cyJdLCJuYW1lcyI6WyJleHRlbmRTdGF0aWNzIiwiX19leHRlbmRzIiwidGhpcyIsImQiLCJiIiwiT2JqZWN0Iiwic2V0UHJvdG90eXBlT2YiLCJfX3Byb3RvX18iLCJBcnJheSIsInAiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJUeXBlRXJyb3IiLCJTdHJpbmciLCJfXyIsImNvbnN0cnVjdG9yIiwiY3JlYXRlIiwiX192YWx1ZXMiLCJvIiwicyIsIlN5bWJvbCIsIml0ZXJhdG9yIiwibSIsImkiLCJsZW5ndGgiLCJuZXh0IiwidmFsdWUiLCJkb25lIiwiZXhwb3J0cyIsIl9fZXNNb2R1bGUiLCJFbGV2YXRvciIsIkVsZXZhdG9yRGlyZWN0aW9uIiwiZXZlbnRfcHJvZHVjZXJfMSIsInV0aWxfMSIsImlkIiwiY3VycmVudEZsb29yIiwiZGlyZWN0aW9uIiwiU3RhbmRpbmciLCJuZXh0RGlyZWN0aW9uIiwiZGVzdGluYXRpb25MaW1pdCIsIk51bWJlciIsIk1BWF9TQUZFX0lOVEVHRVIiLCJwYXNzZW5nZXJzIiwiRWxldmF0b3JTeXN0ZW0iLCJfc3VwZXIiLCJfdGhpcyIsImFwcGx5IiwiYXJndW1lbnRzIiwiZWxldmF0b3JzIiwiTWFwIiwid2FpdGluZ1Bhc3NlbmdlcnMiLCJhZGROZXdFbGV2YXRvciIsImluaXRpYWxGbG9vciIsImdlbmVyYXRlVW5pcXVlSWQiLCJvYmoiLCJzZXQiLCJlbWl0IiwiYWRkTmV3UGFzc2VuZ2VyIiwiX2EiLCJuYW1lIiwiZGVzdGluYXRpb25GbG9vciIsImlzTmFOIiwiRXJyb3IiLCJwYXNzZW5nZXIiLCJHb2luZ0Rvd24iLCJHb2luZ1VwIiwidW5zaGlmdCIsImNvbW1pdE5leHRTdGVwIiwiZV8xIiwiZV8yIiwiX2IiLCJlXzMiLCJfYyIsImVfNCIsIl9kIiwiZV81IiwiX2UiLCJjaGFuZ2VkRWxldmF0b3JJZHMiLCJTZXQiLCJfZiIsInZhbHVlcyIsIl9nIiwiZWxldmF0b3IiLCJhZGQiLCJzcGxpY2UiLCJpc1NvbWVvbmUiLCJ0bXAiLCJfaCIsIl9qIiwiZV8yXzEiLCJlcnJvciIsInB1c2giLCJlXzFfMSIsIl9rIiwiX2wiLCJfbG9vcF8xIiwiZV82IiwiX3AiLCJpc0FueSIsIl9xIiwidGhpc18xIiwiX3IiLCJvdGhlckVsZXZhdG9yIiwiZV82XzEiLCJNYXRoIiwic2lnbiIsInBhc3Nlbmdlcl8xIiwibGltaXRfMSIsImZvckVhY2giLCJfbSIsIl9vIiwiZV80XzEiLCJlXzNfMSIsImNoYW5nZWRFbGV2YXRvcklkc18xIiwiY2hhbmdlZEVsZXZhdG9ySWRzXzFfMSIsImdldCIsImVfNV8xIiwiRXZlbnRQcm9kdWNlciIsImxpc3RlbmVycyIsImFkZEV2ZW50TGlzdGVuZXIiLCJ0eXBlIiwibGlzdGVuZXIiLCJsaXN0IiwiZXZlbnQiLCJsIiwibmV4dElkIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwidW5kZWZpbmVkIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsImVsZXZhdG9yX3N5c3RlbV8xIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwic3R5bGUiLCJkaXNwbGF5Iiwic3lzdGVtIiwiZWxldmF0b3JzTGlzdERpdiIsImdldEVsZW1lbnRCeUlkIiwid2FpdGluZ1Bhc3NlbmdlcnNMaXN0RGl2IiwiZm9ybWF0RGlyZWN0aW9uIiwiZGlyIiwicHJvbXB0IiwiZWwiLCJlbGV2YXRvckRpdiIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJpbm5lclRleHQiLCJhcHBlbmRDaGlsZCIsInJlbW92ZSIsImxpc3RPZkluc2lkZXJzIl0sIm1hcHBpbmdzIjoiOENBQ0EsSUFDUUEsRUFESkMsRUFBYUMsTUFBUUEsS0FBS0QsWUFDdEJELEVBQWdCLFNBQVVHLEVBQUdDLEdBSTdCLE9BSEFKLEVBQWdCSyxPQUFPQyxnQkFDbEIsQ0FBRUMsVUFBVyxjQUFnQkMsT0FBUyxTQUFVTCxFQUFHQyxHQUFLRCxFQUFFSSxVQUFZSCxJQUN2RSxTQUFVRCxFQUFHQyxHQUFLLElBQUssSUFBSUssS0FBS0wsRUFBT0MsT0FBT0ssVUFBVUMsZUFBZUMsS0FBS1IsRUFBR0ssS0FBSU4sRUFBRU0sR0FBS0wsRUFBRUssTUFDM0VOLEVBQUdDLElBRXJCLFNBQVVELEVBQUdDLEdBQ2hCLEdBQWlCLG1CQUFOQSxHQUEwQixPQUFOQSxFQUMzQixNQUFNLElBQUlTLFVBQVUsdUJBQXlCQyxPQUFPVixHQUFLLGlDQUU3RCxTQUFTVyxJQUFPYixLQUFLYyxZQUFjYixFQURuQ0gsRUFBY0csRUFBR0MsR0FFakJELEVBQUVPLFVBQWtCLE9BQU5OLEVBQWFDLE9BQU9ZLE9BQU9iLElBQU1XLEVBQUdMLFVBQVlOLEVBQUVNLFVBQVcsSUFBSUssS0FHbkZHLEVBQVloQixNQUFRQSxLQUFLZ0IsVUFBYSxTQUFTQyxHQUMvQyxJQUFJQyxFQUFzQixtQkFBWEMsUUFBeUJBLE9BQU9DLFNBQVVDLEVBQUlILEdBQUtELEVBQUVDLEdBQUlJLEVBQUksRUFDNUUsR0FBSUQsRUFBRyxPQUFPQSxFQUFFWCxLQUFLTyxHQUNyQixHQUFJQSxHQUF5QixpQkFBYkEsRUFBRU0sT0FBcUIsTUFBTyxDQUMxQ0MsS0FBTSxXQUVGLE9BRElQLEdBQUtLLEdBQUtMLEVBQUVNLFNBQVFOLE9BQUksR0FDckIsQ0FBRVEsTUFBT1IsR0FBS0EsRUFBRUssS0FBTUksTUFBT1QsS0FHNUMsTUFBTSxJQUFJTixVQUFVTyxFQUFJLDBCQUE0QixvQ0FFeERTLEVB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RUFBVTdCLElBQUlxSCxhIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xudmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcbnZhciBfX3ZhbHVlcyA9ICh0aGlzICYmIHRoaXMuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHtcbiAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwO1xuICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pO1xuICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gXCJudW1iZXJcIikgcmV0dXJuIHtcbiAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDtcbiAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gXCJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLlwiIDogXCJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xufTtcbmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5leHBvcnRzLkVsZXZhdG9yID0gZXhwb3J0cy5FbGV2YXRvckRpcmVjdGlvbiA9IHZvaWQgMDtcbnZhciBldmVudF9wcm9kdWNlcl8xID0gcmVxdWlyZShcIi4vZXZlbnQtcHJvZHVjZXJcIik7XG52YXIgdXRpbF8xID0gcmVxdWlyZShcIi4vdXRpbFwiKTtcbnZhciBFbGV2YXRvckRpcmVjdGlvbjtcbihmdW5jdGlvbiAoRWxldmF0b3JEaXJlY3Rpb24pIHtcbiAgICBFbGV2YXRvckRpcmVjdGlvbltFbGV2YXRvckRpcmVjdGlvbltcIlN0YW5kaW5nXCJdID0gMF0gPSBcIlN0YW5kaW5nXCI7XG4gICAgRWxldmF0b3JEaXJlY3Rpb25bRWxldmF0b3JEaXJlY3Rpb25bXCJHb2luZ1VwXCJdID0gMV0gPSBcIkdvaW5nVXBcIjtcbiAgICBFbGV2YXRvckRpcmVjdGlvbltFbGV2YXRvckRpcmVjdGlvbltcIkdvaW5nRG93blwiXSA9IC0xXSA9IFwiR29pbmdEb3duXCI7XG59KShFbGV2YXRvckRpcmVjdGlvbiA9IGV4cG9ydHMuRWxldmF0b3JEaXJlY3Rpb24gfHwgKGV4cG9ydHMuRWxldmF0b3JEaXJlY3Rpb24gPSB7fSkpO1xudmFyIEVsZXZhdG9yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEVsZXZhdG9yKGlkKSB7XG4gICAgICAgIHRoaXMuaWQgPSBpZDtcbiAgICAgICAgdGhpcy5jdXJyZW50Rmxvb3IgPSAwO1xuICAgICAgICB0aGlzLmRpcmVjdGlvbiA9IEVsZXZhdG9yRGlyZWN0aW9uLlN0YW5kaW5nO1xuICAgICAgICB0aGlzLm5leHREaXJlY3Rpb24gPSBFbGV2YXRvckRpcmVjdGlvbi5TdGFuZGluZztcbiAgICAgICAgdGhpcy5kZXN0aW5hdGlvbkxpbWl0ID0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7XG4gICAgICAgIHRoaXMucGFzc2VuZ2VycyA9IFtdO1xuICAgIH1cbiAgICByZXR1cm4gRWxldmF0b3I7XG59KCkpO1xuZXhwb3J0cy5FbGV2YXRvciA9IEVsZXZhdG9yO1xudmFyIEVsZXZhdG9yU3lzdGVtID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhFbGV2YXRvclN5c3RlbSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBFbGV2YXRvclN5c3RlbSgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgIC8vIGlkIHRvIEVsZXZhdG9yXG4gICAgICAgIF90aGlzLmVsZXZhdG9ycyA9IG5ldyBNYXAoKTtcbiAgICAgICAgX3RoaXMud2FpdGluZ1Bhc3NlbmdlcnMgPSBbXTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBFbGV2YXRvclN5c3RlbS5wcm90b3R5cGUuYWRkTmV3RWxldmF0b3IgPSBmdW5jdGlvbiAoaW5pdGlhbEZsb29yKSB7XG4gICAgICAgIHZhciBpZCA9IHV0aWxfMS5nZW5lcmF0ZVVuaXF1ZUlkKCk7XG4gICAgICAgIHZhciBvYmogPSBuZXcgRWxldmF0b3IoaWQpO1xuICAgICAgICBvYmouY3VycmVudEZsb29yID0gK2luaXRpYWxGbG9vciB8fCAwO1xuICAgICAgICB0aGlzLmVsZXZhdG9ycy5zZXQoaWQsIG9iaik7XG4gICAgICAgIHRoaXMuZW1pdCgnZWxldmF0b3ItYWRkZWQnLCBvYmopO1xuICAgIH07XG4gICAgRWxldmF0b3JTeXN0ZW0ucHJvdG90eXBlLmFkZE5ld1Bhc3NlbmdlciA9IGZ1bmN0aW9uIChfYSkge1xuICAgICAgICB2YXIgbmFtZSA9IF9hLm5hbWUsIGluaXRpYWxGbG9vciA9IF9hLmluaXRpYWxGbG9vciwgZGVzdGluYXRpb25GbG9vciA9IF9hLmRlc3RpbmF0aW9uRmxvb3I7XG4gICAgICAgIGlmIChpc05hTihpbml0aWFsRmxvb3IpIHx8IGlzTmFOKGRlc3RpbmF0aW9uRmxvb3IpKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHBhc3NlbmdlcnMgcGFyYW1ldGVycycpO1xuICAgICAgICBpZiAoaW5pdGlhbEZsb29yID09PSBkZXN0aW5hdGlvbkZsb29yKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdQYXNzZW5nZXIgaXMgYWxyZWFkeSBvbiB0aGUgZGVzdGluYXRpb24gZmxvb3InKTtcbiAgICAgICAgdmFyIHBhc3NlbmdlciA9IHtcbiAgICAgICAgICAgIGlkOiB1dGlsXzEuZ2VuZXJhdGVVbmlxdWVJZCgpLFxuICAgICAgICAgICAgZGlyZWN0aW9uOiBkZXN0aW5hdGlvbkZsb29yIDwgaW5pdGlhbEZsb29yID8gRWxldmF0b3JEaXJlY3Rpb24uR29pbmdEb3duIDogRWxldmF0b3JEaXJlY3Rpb24uR29pbmdVcCxcbiAgICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgICBpbml0aWFsRmxvb3I6IGluaXRpYWxGbG9vcixcbiAgICAgICAgICAgIGRlc3RpbmF0aW9uRmxvb3I6IGRlc3RpbmF0aW9uRmxvb3IsXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMud2FpdGluZ1Bhc3NlbmdlcnMudW5zaGlmdChwYXNzZW5nZXIpO1xuICAgICAgICB0aGlzLmVtaXQoJ3dhaXRpbmctcGFzc2VuZ2VyLWFkZGVkJywgcGFzc2VuZ2VyKTtcbiAgICB9O1xuICAgIEVsZXZhdG9yU3lzdGVtLnByb3RvdHlwZS5jb21taXROZXh0U3RlcCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGVfMSwgX2EsIGVfMiwgX2IsIGVfMywgX2MsIGVfNCwgX2QsIGVfNSwgX2U7XG4gICAgICAgIHZhciBjaGFuZ2VkRWxldmF0b3JJZHMgPSBuZXcgU2V0KCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBmb3IgKHZhciBfZiA9IF9fdmFsdWVzKHRoaXMuZWxldmF0b3JzLnZhbHVlcygpKSwgX2cgPSBfZi5uZXh0KCk7ICFfZy5kb25lOyBfZyA9IF9mLm5leHQoKSkge1xuICAgICAgICAgICAgICAgIHZhciBlbGV2YXRvciA9IF9nLnZhbHVlO1xuICAgICAgICAgICAgICAgIGlmIChlbGV2YXRvci5kaXJlY3Rpb24gIT09IEVsZXZhdG9yRGlyZWN0aW9uLlN0YW5kaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIG1vdmUgdGhlIGVsZXZhdG9yXG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZWRFbGV2YXRvcklkcy5hZGQoZWxldmF0b3IuaWQpO1xuICAgICAgICAgICAgICAgICAgICBlbGV2YXRvci5jdXJyZW50Rmxvb3IgKz0gZWxldmF0b3IuZGlyZWN0aW9uO1xuICAgICAgICAgICAgICAgICAgICAvLyBkcm9wIHBhc3NlbmdlcnMgdGhhdCB3YW50cyB0byBiZSBvbiB0aGlzIGZsb29yXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSBlbGV2YXRvci5wYXNzZW5nZXJzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFzc2VuZ2VyID0gZWxldmF0b3IucGFzc2VuZ2Vyc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXNzZW5nZXIuZGVzdGluYXRpb25GbG9vciA9PT0gZWxldmF0b3IuY3VycmVudEZsb29yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxldmF0b3IucGFzc2VuZ2Vycy5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0KCdwYXNzZW5nZXItZHJvcHBlZCcsIHsgcGFzc2VuZ2VyOiBwYXNzZW5nZXIsIGVsZXZhdG9yOiBlbGV2YXRvciB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGUgZWxldmF0b3IgaXMgYXQgdGhlIGxpbWl0IGZsb29yIHRoaXMgbWVhbnMgaXQgbmVlZHMgdG8gY2hhbmdlIHRoZSBkaXJlY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgaWYgKGVsZXZhdG9yLm5leHREaXJlY3Rpb24gIT09IEVsZXZhdG9yRGlyZWN0aW9uLlN0YW5kaW5nICYmIGVsZXZhdG9yLmN1cnJlbnRGbG9vciA9PT0gZWxldmF0b3IuZGVzdGluYXRpb25MaW1pdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZWxldmF0b3IuZGlyZWN0aW9uID0gZWxldmF0b3IubmV4dERpcmVjdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsZXZhdG9yLm5leHREaXJlY3Rpb24gPSBFbGV2YXRvckRpcmVjdGlvbi5TdGFuZGluZztcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsZXZhdG9yLmRlc3RpbmF0aW9uTGltaXQgPSBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUiAqIGVsZXZhdG9yLmRpcmVjdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChlbGV2YXRvci5wYXNzZW5nZXJzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVsZXZhdG9yLm5leHREaXJlY3Rpb24gIT09IEVsZXZhdG9yRGlyZWN0aW9uLlN0YW5kaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXZlbiB0aG91aCB0aGlzIGVsZXZhdG9yIGlzIGVtcHR5IGl0IG5lZWRzIHRvIGdvIHRoaXMgd2F5IGFueXdheVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbG9va3MgbGlrZSB0aGlzIGVsZXZhdG9yIGlzIGVtcHR5IG5vdywgY2hlY2sgaWYgdGhlcmUgaXMgYW55IHBhc3NlbmdlciBpbiB0aGlzIHdheSB0aGF0IHdhbnRzIHRvIGdvIHRoaXMgd2F5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlzU29tZW9uZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0bXAgPSBlbGV2YXRvci5jdXJyZW50Rmxvb3IgKiBlbGV2YXRvci5kaXJlY3Rpb247XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2ggPSAoZV8yID0gdm9pZCAwLCBfX3ZhbHVlcyh0aGlzLndhaXRpbmdQYXNzZW5nZXJzKSksIF9qID0gX2gubmV4dCgpOyAhX2ouZG9uZTsgX2ogPSBfaC5uZXh0KCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXNzZW5nZXIgPSBfai52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXNzZW5nZXIuaW5pdGlhbEZsb29yICogZWxldmF0b3IuZGlyZWN0aW9uID49IHRtcCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3Nlbmdlci5kaXJlY3Rpb24gPT09IGVsZXZhdG9yLmRpcmVjdGlvbiAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3Nlbmdlci5kZXN0aW5hdGlvbkZsb29yICogZWxldmF0b3IuZGlyZWN0aW9uIDw9IGVsZXZhdG9yLmRlc3RpbmF0aW9uTGltaXQgKiBlbGV2YXRvci5kaXJlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc1NvbWVvbmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChlXzJfMSkgeyBlXzIgPSB7IGVycm9yOiBlXzJfMSB9OyB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX2ogJiYgIV9qLmRvbmUgJiYgKF9iID0gX2hbXCJyZXR1cm5cIl0pKSBfYi5jYWxsKF9oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMikgdGhyb3cgZV8yLmVycm9yOyB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNTb21lb25lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vaWYgbm90IHRoZW4gc3dpdGNoIGRpcmVjdGlvbiB0byBzdGFuZGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGV2YXRvci5kaXJlY3Rpb24gPSBFbGV2YXRvckRpcmVjdGlvbi5TdGFuZGluZztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gdGFrZSBwYXNzZW5nZXJzIHRoYXQgd2FudCB0byBnbyB0aGlzIHdheSBhbmQgYXJlIG9uIHRoaXMgZmxvb3IgYW5kIHRoZXkgYXJlIHdpdGhpbiB0aGUgbGltaXRcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IHRoaXMud2FpdGluZ1Bhc3NlbmdlcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXNzZW5nZXIgPSB0aGlzLndhaXRpbmdQYXNzZW5nZXJzW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhc3Nlbmdlci5pbml0aWFsRmxvb3IgPT09IGVsZXZhdG9yLmN1cnJlbnRGbG9vciAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3Nlbmdlci5kaXJlY3Rpb24gPT09IGVsZXZhdG9yLmRpcmVjdGlvbiAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3Nlbmdlci5kZXN0aW5hdGlvbkZsb29yICogZWxldmF0b3IuZGlyZWN0aW9uIDwgZWxldmF0b3IuZGVzdGluYXRpb25MaW1pdCAqIGVsZXZhdG9yLmRpcmVjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZXZhdG9yLnBhc3NlbmdlcnMucHVzaChwYXNzZW5nZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMud2FpdGluZ1Bhc3NlbmdlcnMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdCgncGFzc2VuZ2VyLXRha2VuJywgeyBwYXNzZW5nZXI6IHBhc3NlbmdlciwgZWxldmF0b3I6IGVsZXZhdG9yIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlXzFfMSkgeyBlXzEgPSB7IGVycm9yOiBlXzFfMSB9OyB9XG4gICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBpZiAoX2cgJiYgIV9nLmRvbmUgJiYgKF9hID0gX2ZbXCJyZXR1cm5cIl0pKSBfYS5jYWxsKF9mKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH1cbiAgICAgICAgfVxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgZm9yICh2YXIgX2sgPSBfX3ZhbHVlcyh0aGlzLmVsZXZhdG9ycy52YWx1ZXMoKSksIF9sID0gX2submV4dCgpOyAhX2wuZG9uZTsgX2wgPSBfay5uZXh0KCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgZWxldmF0b3IgPSBfbC52YWx1ZTtcbiAgICAgICAgICAgICAgICBpZiAoZWxldmF0b3IuZGlyZWN0aW9uID09IEVsZXZhdG9yRGlyZWN0aW9uLlN0YW5kaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfbG9vcF8xID0gZnVuY3Rpb24gKHBhc3Nlbmdlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVfNiwgX3A7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBpZiB0aGVyZSBpcyBhbnkgZWxldmF0b3IgZ29pbmcgdG8gdGhhdCBwZXJzaW9uLCBvciB3aWxsIHRha2UgaXQgaW4gdGhlIG5lYXIgZnV0dXJlXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXNBbnkgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX3EgPSAoZV82ID0gdm9pZCAwLCBfX3ZhbHVlcyh0aGlzXzEuZWxldmF0b3JzLnZhbHVlcygpKSksIF9yID0gX3EubmV4dCgpOyAhX3IuZG9uZTsgX3IgPSBfcS5uZXh0KCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG90aGVyRWxldmF0b3IgPSBfci52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChvdGhlckVsZXZhdG9yLmRpcmVjdGlvbiAhPT0gRWxldmF0b3JEaXJlY3Rpb24uU3RhbmRpbmcgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3Nlbmdlci5pbml0aWFsRmxvb3IgKiBvdGhlckVsZXZhdG9yLmRpcmVjdGlvbiA+IG90aGVyRWxldmF0b3IuY3VycmVudEZsb29yICogb3RoZXJFbGV2YXRvci5kaXJlY3Rpb24gJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3Nlbmdlci5kZXN0aW5hdGlvbkZsb29yICogZWxldmF0b3IuZGlyZWN0aW9uIDw9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3RoZXJFbGV2YXRvci5kZXN0aW5hdGlvbkxpbWl0ICogb3RoZXJFbGV2YXRvci5kaXJlY3Rpb24gJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3Nlbmdlci5kaXJlY3Rpb24gPT09IG90aGVyRWxldmF0b3IuZGlyZWN0aW9uKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKG90aGVyRWxldmF0b3IuZGlyZWN0aW9uICE9PSBFbGV2YXRvckRpcmVjdGlvbi5TdGFuZGluZyAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG90aGVyRWxldmF0b3IubmV4dERpcmVjdGlvbiAhPT0gRWxldmF0b3JEaXJlY3Rpb24uU3RhbmRpbmcgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzZW5nZXIuaW5pdGlhbEZsb29yICogb3RoZXJFbGV2YXRvci5kaXJlY3Rpb24gPD1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3RoZXJFbGV2YXRvci5kZXN0aW5hdGlvbkxpbWl0ICogb3RoZXJFbGV2YXRvci5kaXJlY3Rpb24gJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzZW5nZXIuZGlyZWN0aW9uID09PSBvdGhlckVsZXZhdG9yLm5leHREaXJlY3Rpb24pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0FueSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChlXzZfMSkgeyBlXzYgPSB7IGVycm9yOiBlXzZfMSB9OyB9XG4gICAgICAgICAgICAgICAgICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3IgJiYgIV9yLmRvbmUgJiYgKF9wID0gX3FbXCJyZXR1cm5cIl0pKSBfcC5jYWxsKF9xKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzYpIHRocm93IGVfNi5lcnJvcjsgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc0FueSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlmIHRoZXJlIGFyZSBub25lLCB0aGVuIG1ha2UgdGhpcyBlbGV2YXRvciBnbyBmb3IgdGhhdCBwZXJzb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGV2YXRvci5kaXJlY3Rpb24gPSBNYXRoLnNpZ24ocGFzc2VuZ2VyLmluaXRpYWxGbG9vciAtIGVsZXZhdG9yLmN1cnJlbnRGbG9vcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVsZXZhdG9yLmRpcmVjdGlvbiA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpbiBjYXNlIHRoZSBwYXNzZW5nZXIgaXMgb25lIHRoZSBzYW1lIGZsb29yIGFzIHRoZSBlbGV2YXRvciwgdGFrZSBpdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGV2YXRvci5kaXJlY3Rpb24gPSBNYXRoLnNpZ24ocGFzc2VuZ2VyLmRlc3RpbmF0aW9uRmxvb3IgLSBwYXNzZW5nZXIuaW5pdGlhbEZsb29yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IHRoaXNfMS53YWl0aW5nUGFzc2VuZ2Vycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhc3Nlbmdlcl8xID0gdGhpc18xLndhaXRpbmdQYXNzZW5nZXJzW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhc3Nlbmdlcl8xLmluaXRpYWxGbG9vciA9PT0gZWxldmF0b3IuY3VycmVudEZsb29yICYmIHBhc3Nlbmdlcl8xLmRpcmVjdGlvbiA9PT0gZWxldmF0b3IuZGlyZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxldmF0b3IucGFzc2VuZ2Vycy5wdXNoKHBhc3Nlbmdlcl8xKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzXzEud2FpdGluZ1Bhc3NlbmdlcnMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNfMS5lbWl0KCdwYXNzZW5nZXItdGFrZW4nLCB7IHBhc3NlbmdlcjogcGFzc2VuZ2VyXzEsIGVsZXZhdG9yOiBlbGV2YXRvciB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGV2YXRvci5uZXh0RGlyZWN0aW9uID0gTWF0aC5zaWduKHBhc3Nlbmdlci5kZXN0aW5hdGlvbkZsb29yIC0gcGFzc2VuZ2VyLmluaXRpYWxGbG9vcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVsZXZhdG9yLm5leHREaXJlY3Rpb24gPT09IGVsZXZhdG9yLmRpcmVjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGV2YXRvci5uZXh0RGlyZWN0aW9uID0gRWxldmF0b3JEaXJlY3Rpb24uU3RhbmRpbmc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZXZhdG9yLmRlc3RpbmF0aW9uTGltaXQgPSBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUiAqIGVsZXZhdG9yLmRpcmVjdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGl0J3MgZ29vZCBpZGVhIHRvIGZpbmQgYSBwZXJzb24gdGhhdCBpcyBvbiBsb3dlc3QvaGVpZ2hlc3QgZmxvb3JcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxpbWl0XzEgPSBwYXNzZW5nZXIuaW5pdGlhbEZsb29yO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzXzEud2FpdGluZ1Bhc3NlbmdlcnMuZm9yRWFjaChlbGV2YXRvci5kaXJlY3Rpb24gPT09IEVsZXZhdG9yRGlyZWN0aW9uLkdvaW5nVXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gZnVuY3Rpb24gKHApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocC5pbml0aWFsRmxvb3IgPiBsaW1pdF8xKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW1pdF8xID0gcC5pbml0aWFsRmxvb3I7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IGZ1bmN0aW9uIChwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHAuaW5pdGlhbEZsb29yIDwgbGltaXRfMSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGltaXRfMSA9IHAuaW5pdGlhbEZsb29yO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZXZhdG9yLmRlc3RpbmF0aW9uTGltaXQgPSBsaW1pdF8xO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VkRWxldmF0b3JJZHMuYWRkKGVsZXZhdG9yLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJicmVha1wiO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGhpc18xID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZpbmQgYSBkaXJlY3Rpb24gdG8gZ28gdG9cbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9tID0gKGVfNCA9IHZvaWQgMCwgX192YWx1ZXModGhpcy53YWl0aW5nUGFzc2VuZ2VycykpLCBfbyA9IF9tLm5leHQoKTsgIV9vLmRvbmU7IF9vID0gX20ubmV4dCgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhc3NlbmdlciA9IF9vLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGF0ZV8xID0gX2xvb3BfMShwYXNzZW5nZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZV8xID09PSBcImJyZWFrXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhdGNoIChlXzRfMSkgeyBlXzQgPSB7IGVycm9yOiBlXzRfMSB9OyB9XG4gICAgICAgICAgICAgICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX28gJiYgIV9vLmRvbmUgJiYgKF9kID0gX21bXCJyZXR1cm5cIl0pKSBfZC5jYWxsKF9tKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV80KSB0aHJvdyBlXzQuZXJyb3I7IH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZV8zXzEpIHsgZV8zID0geyBlcnJvcjogZV8zXzEgfTsgfVxuICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgaWYgKF9sICYmICFfbC5kb25lICYmIChfYyA9IF9rW1wicmV0dXJuXCJdKSkgX2MuY2FsbChfayk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMykgdGhyb3cgZV8zLmVycm9yOyB9XG4gICAgICAgIH1cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGZvciAodmFyIGNoYW5nZWRFbGV2YXRvcklkc18xID0gX192YWx1ZXMoY2hhbmdlZEVsZXZhdG9ySWRzKSwgY2hhbmdlZEVsZXZhdG9ySWRzXzFfMSA9IGNoYW5nZWRFbGV2YXRvcklkc18xLm5leHQoKTsgIWNoYW5nZWRFbGV2YXRvcklkc18xXzEuZG9uZTsgY2hhbmdlZEVsZXZhdG9ySWRzXzFfMSA9IGNoYW5nZWRFbGV2YXRvcklkc18xLm5leHQoKSkge1xuICAgICAgICAgICAgICAgIHZhciBpZCA9IGNoYW5nZWRFbGV2YXRvcklkc18xXzEudmFsdWU7XG4gICAgICAgICAgICAgICAgdGhpcy5lbWl0KCdlbGV2YXRvci11cGRhdGVkJywgdGhpcy5lbGV2YXRvcnMuZ2V0KGlkKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVfNV8xKSB7IGVfNSA9IHsgZXJyb3I6IGVfNV8xIH07IH1cbiAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGlmIChjaGFuZ2VkRWxldmF0b3JJZHNfMV8xICYmICFjaGFuZ2VkRWxldmF0b3JJZHNfMV8xLmRvbmUgJiYgKF9lID0gY2hhbmdlZEVsZXZhdG9ySWRzXzFbXCJyZXR1cm5cIl0pKSBfZS5jYWxsKGNoYW5nZWRFbGV2YXRvcklkc18xKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV81KSB0aHJvdyBlXzUuZXJyb3I7IH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIEVsZXZhdG9yU3lzdGVtO1xufShldmVudF9wcm9kdWNlcl8xW1wiZGVmYXVsdFwiXSkpO1xuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBFbGV2YXRvclN5c3RlbTtcbiIsIlwidXNlIHN0cmljdFwiO1xudmFyIF9fdmFsdWVzID0gKHRoaXMgJiYgdGhpcy5fX3ZhbHVlcykgfHwgZnVuY3Rpb24obykge1xuICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7XG4gICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7XG4gICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSBcIm51bWJlclwiKSByZXR1cm4ge1xuICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwO1xuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9O1xuICAgICAgICB9XG4gICAgfTtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyBcIk9iamVjdCBpcyBub3QgaXRlcmFibGUuXCIgOiBcIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XG59O1xuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcbnZhciBFdmVudFByb2R1Y2VyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEV2ZW50UHJvZHVjZXIoKSB7XG4gICAgICAgIHRoaXMubGlzdGVuZXJzID0gbmV3IE1hcCgpO1xuICAgIH1cbiAgICBFdmVudFByb2R1Y2VyLnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKHR5cGUsIGxpc3RlbmVyKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgdmFyIGxpc3QgPSAoX2EgPSB0aGlzLmxpc3RlbmVycy5nZXQodHlwZSkpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IFtdO1xuICAgICAgICBsaXN0LnB1c2gobGlzdGVuZXIpO1xuICAgICAgICB0aGlzLmxpc3RlbmVycy5zZXQodHlwZSwgbGlzdCk7XG4gICAgfTtcbiAgICBFdmVudFByb2R1Y2VyLnByb3RvdHlwZS5lbWl0ID0gZnVuY3Rpb24gKHR5cGUsIGV2ZW50KSB7XG4gICAgICAgIHZhciBlXzEsIF9hO1xuICAgICAgICB2YXIgX2I7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBmb3IgKHZhciBfYyA9IF9fdmFsdWVzKCgoX2IgPSB0aGlzLmxpc3RlbmVycy5nZXQodHlwZSkpICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IFtdKSksIF9kID0gX2MubmV4dCgpOyAhX2QuZG9uZTsgX2QgPSBfYy5uZXh0KCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgbCA9IF9kLnZhbHVlO1xuICAgICAgICAgICAgICAgIGwoZXZlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlXzFfMSkgeyBlXzEgPSB7IGVycm9yOiBlXzFfMSB9OyB9XG4gICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBpZiAoX2QgJiYgIV9kLmRvbmUgJiYgKF9hID0gX2NbXCJyZXR1cm5cIl0pKSBfYS5jYWxsKF9jKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIEV2ZW50UHJvZHVjZXI7XG59KCkpO1xuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBFdmVudFByb2R1Y2VyO1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuZXhwb3J0cy5nZW5lcmF0ZVVuaXF1ZUlkID0gdm9pZCAwO1xudmFyIG5leHRJZCA9IDE7XG52YXIgZ2VuZXJhdGVVbmlxdWVJZCA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gbmV4dElkKys7XG59O1xuZXhwb3J0cy5nZW5lcmF0ZVVuaXF1ZUlkID0gZ2VuZXJhdGVVbmlxdWVJZDtcbiIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCJcInVzZSBzdHJpY3RcIjtcbmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG52YXIgZWxldmF0b3Jfc3lzdGVtXzEgPSByZXF1aXJlKFwiLi9lbGV2YXRvci1zeXN0ZW1cIik7XG4vLyBzaG93IG1haW4gYm94IHdoZW4gSlMgaXMgZW5hYmxlZFxuZG9jdW1lbnQucXVlcnlTZWxlY3RvcignbWFpbicpLnN0eWxlLmRpc3BsYXkgPSBudWxsO1xudmFyIHN5c3RlbSA9IG5ldyBlbGV2YXRvcl9zeXN0ZW1fMVtcImRlZmF1bHRcIl0oKTtcbi8vIHdpbmRvdy5zeXN0ZW0gPSBzeXN0ZW1cbnZhciBlbGV2YXRvcnNMaXN0RGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2VsZXZhdG9ycy1saXN0Jyk7XG52YXIgd2FpdGluZ1Bhc3NlbmdlcnNMaXN0RGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dhaXRpbmctcGFzc2VuZ2Vycy1saXN0Jyk7XG52YXIgZm9ybWF0RGlyZWN0aW9uID0gZnVuY3Rpb24gKGRpcikge1xuICAgIHN3aXRjaCAoZGlyKSB7XG4gICAgICAgIGNhc2UgZWxldmF0b3Jfc3lzdGVtXzEuRWxldmF0b3JEaXJlY3Rpb24uR29pbmdVcDpcbiAgICAgICAgICAgIHJldHVybiAndXAnO1xuICAgICAgICBjYXNlIGVsZXZhdG9yX3N5c3RlbV8xLkVsZXZhdG9yRGlyZWN0aW9uLkdvaW5nRG93bjpcbiAgICAgICAgICAgIHJldHVybiAnZG93bic7XG4gICAgICAgIGNhc2UgZWxldmF0b3Jfc3lzdGVtXzEuRWxldmF0b3JEaXJlY3Rpb24uU3RhbmRpbmc6XG4gICAgICAgICAgICByZXR1cm4gJ25vbmUnO1xuICAgIH1cbn07XG4vLyBET00gZXZlbnRzOlxuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FkZC1lbGV2YXRvci1idG4nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICBzeXN0ZW0uYWRkTmV3RWxldmF0b3IoK3Byb21wdCgnV2hhdCBmbG9vciBpcyB0aGF0IGVsZXZhdG9yIGluaXRpYWxseSBvbj8nKSk7XG59KTtcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhZGQtcGFzc2VuZ2VyLWJ0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgIHN5c3RlbS5hZGROZXdQYXNzZW5nZXIoe1xuICAgICAgICBuYW1lOiBwcm9tcHQoJ0dpdmUgYSBwYXNzZW5nZXIgbmFtZScsICcnKSB8fCAnJyxcbiAgICAgICAgaW5pdGlhbEZsb29yOiArcHJvbXB0KCdUaGF0IGZsb29yIGlzIHRoYXQgcGFzc2VuZ2VyIG9uPycpLFxuICAgICAgICBkZXN0aW5hdGlvbkZsb29yOiArcHJvbXB0KCdUaGF0IGZsb29yIGlzIHRoYXQgcGFzc2VuZ2VyIGdvaW5nIHRvIGdvPycpLFxuICAgIH0pO1xufSk7XG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmV4dC1zdGVwLWJ0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkgeyByZXR1cm4gc3lzdGVtLmNvbW1pdE5leHRTdGVwKCk7IH0pO1xuLy8gc3lzdGVtIGV2ZW50c1xuc3lzdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2VsZXZhdG9yLWFkZGVkJywgZnVuY3Rpb24gKGVsZXZhdG9yKSB7XG4gICAgdmFyIGVsZXZhdG9yRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgZWxldmF0b3JEaXYuaWQgPSBcImVsZXZhdG9yLWlkLVwiICsgZWxldmF0b3IuaWQ7XG4gICAgZWxldmF0b3JEaXYuY2xhc3NMaXN0LmFkZCgnZWxldmF0b3InKTtcbiAgICAvLyAgIHtcbiAgICAvLyAgICAgY29uc3QgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIC8vICAgICBlbC5jbGFzc0xpc3QuYWRkKFwiZWxldmF0b3ItaWQtdmFsdWVcIik7XG4gICAgLy8gICAgIGVsLmlubmVyVGV4dCA9IGAke2VsZXZhdG9yLmlkfWA7XG4gICAgLy8gICAgIGVsZXZhdG9yRGl2LmFwcGVuZENoaWxkKGVsKTtcbiAgICAvLyAgIH1cbiAgICAvLyAgIHtcbiAgICAvLyAgICAgY29uc3QgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIC8vICAgICBlbC5jbGFzc0xpc3QuYWRkKFwiZWxldmF0b3ItaWQtdGl0bGVcIik7XG4gICAgLy8gICAgIGVsLmlubmVyVGV4dCA9IGBFbGV2YXRvciBJRGA7XG4gICAgLy8gICAgIGVsZXZhdG9yRGl2LmFwcGVuZENoaWxkKGVsKTtcbiAgICAvLyAgIH1cbiAgICB7XG4gICAgICAgIHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBlbC5jbGFzc0xpc3QuYWRkKCdjdXJyZW50LWZsb29yLXZhbHVlJyk7XG4gICAgICAgIGVsLmlubmVyVGV4dCA9IFwiXCIgKyBlbGV2YXRvci5jdXJyZW50Rmxvb3I7XG4gICAgICAgIGVsZXZhdG9yRGl2LmFwcGVuZENoaWxkKGVsKTtcbiAgICB9XG4gICAge1xuICAgICAgICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgZWwuaW5uZXJUZXh0ID0gXCJDdXJyZW50IGZsb29yXCI7XG4gICAgICAgIGVsZXZhdG9yRGl2LmFwcGVuZENoaWxkKGVsKTtcbiAgICB9XG4gICAge1xuICAgICAgICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgZWwuY2xhc3NMaXN0LmFkZCgnZGlyZWN0aW9uLXZhbHVlJyk7XG4gICAgICAgIGVsLmlubmVyVGV4dCA9IFwiXCIgKyBmb3JtYXREaXJlY3Rpb24oZWxldmF0b3IuZGlyZWN0aW9uKTtcbiAgICAgICAgZWxldmF0b3JEaXYuYXBwZW5kQ2hpbGQoZWwpO1xuICAgIH1cbiAgICB7XG4gICAgICAgIHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBlbC5pbm5lclRleHQgPSBcIkRpcmVjdGlvblwiO1xuICAgICAgICBlbGV2YXRvckRpdi5hcHBlbmRDaGlsZChlbCk7XG4gICAgfVxuICAgIC8vIHtcbiAgICAvLyAgICAgY29uc3QgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIC8vICAgICBlbC5jbGFzc0xpc3QuYWRkKCdsaW1pdC1mbG9vci12YWx1ZScpXG4gICAgLy8gICAgIGVsLmlubmVyVGV4dCA9IGAke2VsZXZhdG9yLmRlc3RpbmF0aW9uTGltaXR9YFxuICAgIC8vICAgICBlbGV2YXRvckRpdi5hcHBlbmRDaGlsZChlbClcbiAgICAvLyB9XG4gICAgLy8ge1xuICAgIC8vICAgICBjb25zdCBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgLy8gICAgIGVsLmlubmVyVGV4dCA9IGBGbG9vciBsaW1pdGBcbiAgICAvLyAgICAgZWxldmF0b3JEaXYuYXBwZW5kQ2hpbGQoZWwpXG4gICAgLy8gfVxuICAgIC8vIHtcbiAgICAvLyAgICAgY29uc3QgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIC8vICAgICBlbC5jbGFzc0xpc3QuYWRkKCduZXh0LWRpcmVjdGlvbi12YWx1ZScpXG4gICAgLy8gICAgIGVsLmlubmVyVGV4dCA9IGAke2Zvcm1hdERpcmVjdGlvbihlbGV2YXRvci5uZXh0RGlyZWN0aW9uKX1gXG4gICAgLy8gICAgIGVsZXZhdG9yRGl2LmFwcGVuZENoaWxkKGVsKVxuICAgIC8vIH1cbiAgICAvLyB7XG4gICAgLy8gICAgIGNvbnN0IGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICAvLyAgICAgZWwuaW5uZXJUZXh0ID0gYE5leHQgZGlyZWN0aW9uYFxuICAgIC8vICAgICBlbGV2YXRvckRpdi5hcHBlbmRDaGlsZChlbClcbiAgICAvLyB9XG4gICAge1xuICAgICAgICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgZWwuY2xhc3NMaXN0LmFkZCgncGFzc2VuZ2Vycy1pbnNpZGUtbGlzdCcpO1xuICAgICAgICBlbGV2YXRvckRpdi5hcHBlbmRDaGlsZChlbCk7XG4gICAgfVxuICAgIGVsZXZhdG9yc0xpc3REaXYuYXBwZW5kQ2hpbGQoZWxldmF0b3JEaXYpO1xufSk7XG5zeXN0ZW0uYWRkRXZlbnRMaXN0ZW5lcignZWxldmF0b3ItdXBkYXRlZCcsIGZ1bmN0aW9uIChlbGV2YXRvcikge1xuICAgIHZhciBlbGV2YXRvckRpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZWxldmF0b3ItaWQtXCIgKyBlbGV2YXRvci5pZCk7XG4gICAgZWxldmF0b3JEaXYucXVlcnlTZWxlY3RvcignLmN1cnJlbnQtZmxvb3ItdmFsdWUnKS5pbm5lclRleHQgPSBcIlwiICsgZWxldmF0b3IuY3VycmVudEZsb29yO1xuICAgIGVsZXZhdG9yRGl2LnF1ZXJ5U2VsZWN0b3IoJy5kaXJlY3Rpb24tdmFsdWUnKS5pbm5lclRleHQgPSBcIlwiICsgZm9ybWF0RGlyZWN0aW9uKGVsZXZhdG9yLmRpcmVjdGlvbik7XG4gICAgLy8gKGVsZXZhdG9yRGl2LnF1ZXJ5U2VsZWN0b3IoJy5saW1pdC1mbG9vci12YWx1ZScpIGFzIEhUTUxEaXZFbGVtZW50KS5pbm5lclRleHQgPSBgJHtlbGV2YXRvci5kZXN0aW5hdGlvbkxpbWl0fWA7XG4gICAgLy8gKGVsZXZhdG9yRGl2LnF1ZXJ5U2VsZWN0b3IoJy5uZXh0LWRpcmVjdGlvbi12YWx1ZScpIGFzIEhUTUxEaXZFbGVtZW50KS5pbm5lclRleHQgPSBgJHtmb3JtYXREaXJlY3Rpb24oZWxldmF0b3IubmV4dERpcmVjdGlvbil9YDtcbn0pO1xuc3lzdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ3dhaXRpbmctcGFzc2VuZ2VyLWFkZGVkJywgZnVuY3Rpb24gKHBhc3Nlbmdlcikge1xuICAgIHZhciBlbGV2YXRvckRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGVsZXZhdG9yRGl2LmlkID0gXCJ3YWl0aW5nLXBhc3Nlbmdlci1pZC1cIiArIHBhc3Nlbmdlci5pZDtcbiAgICBlbGV2YXRvckRpdi5jbGFzc0xpc3QuYWRkKCd3YWl0aW5nLXBhc3NlbmdlcicpO1xuICAgIHtcbiAgICAgICAgdmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGVsLmlubmVyVGV4dCA9IFwiXCIgKyBwYXNzZW5nZXIubmFtZTtcbiAgICAgICAgZWxldmF0b3JEaXYuYXBwZW5kQ2hpbGQoZWwpO1xuICAgIH1cbiAgICB7XG4gICAgICAgIHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBlbC5pbm5lclRleHQgPSBcIk5hbWVcIjtcbiAgICAgICAgZWxldmF0b3JEaXYuYXBwZW5kQ2hpbGQoZWwpO1xuICAgIH1cbiAgICB7XG4gICAgICAgIHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBlbC5pbm5lclRleHQgPSBcIlwiICsgcGFzc2VuZ2VyLmluaXRpYWxGbG9vcjtcbiAgICAgICAgZWxldmF0b3JEaXYuYXBwZW5kQ2hpbGQoZWwpO1xuICAgIH1cbiAgICB7XG4gICAgICAgIHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBlbC5pbm5lclRleHQgPSBcIldhaXRpbmcgYXRcIjtcbiAgICAgICAgZWxldmF0b3JEaXYuYXBwZW5kQ2hpbGQoZWwpO1xuICAgIH1cbiAgICB7XG4gICAgICAgIHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBlbC5pbm5lclRleHQgPSBcIlwiICsgcGFzc2VuZ2VyLmRlc3RpbmF0aW9uRmxvb3I7XG4gICAgICAgIGVsZXZhdG9yRGl2LmFwcGVuZENoaWxkKGVsKTtcbiAgICB9XG4gICAge1xuICAgICAgICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgZWwuaW5uZXJUZXh0ID0gXCJEZXN0aW5hdGlvbiBmbG9vclwiO1xuICAgICAgICBlbGV2YXRvckRpdi5hcHBlbmRDaGlsZChlbCk7XG4gICAgfVxuICAgIHdhaXRpbmdQYXNzZW5nZXJzTGlzdERpdi5hcHBlbmRDaGlsZChlbGV2YXRvckRpdik7XG59KTtcbnN5c3RlbS5hZGRFdmVudExpc3RlbmVyKCdwYXNzZW5nZXItdGFrZW4nLCBmdW5jdGlvbiAoX2EpIHtcbiAgICB2YXIgcGFzc2VuZ2VyID0gX2EucGFzc2VuZ2VyLCBlbGV2YXRvciA9IF9hLmVsZXZhdG9yO1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwid2FpdGluZy1wYXNzZW5nZXItaWQtXCIgKyBwYXNzZW5nZXIuaWQpLnJlbW92ZSgpO1xuICAgIHZhciBsaXN0T2ZJbnNpZGVycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWxldmF0b3ItaWQtXCIgKyBlbGV2YXRvci5pZCArIFwiIC5wYXNzZW5nZXJzLWluc2lkZS1saXN0XCIpO1xuICAgIHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGVsLmlkID0gXCJwYXNzZW5nZXJfXCIgKyBwYXNzZW5nZXIuaWQ7XG4gICAgZWwuY2xhc3NMaXN0LmFkZCgncGFzc2VuZ2VyLWluc2lkZScpO1xuICAgIGVsLmlubmVyVGV4dCA9IFwiXCIgKyBwYXNzZW5nZXIubmFtZTtcbiAgICBsaXN0T2ZJbnNpZGVycy5hcHBlbmRDaGlsZChlbCk7XG59KTtcbnN5c3RlbS5hZGRFdmVudExpc3RlbmVyKCdwYXNzZW5nZXItZHJvcHBlZCcsIGZ1bmN0aW9uIChfYSkge1xuICAgIHZhciBwYXNzZW5nZXIgPSBfYS5wYXNzZW5nZXIsIGVsZXZhdG9yID0gX2EuZWxldmF0b3I7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlbGV2YXRvci1pZC1cIiArIGVsZXZhdG9yLmlkICsgXCIgI3Bhc3Nlbmdlcl9cIiArIHBhc3Nlbmdlci5pZCkucmVtb3ZlKCk7XG59KTtcbi8vIHN5c3RlbS5hZGROZXdFbGV2YXRvcigpXG4vLyBzeXN0ZW0uYWRkTmV3UGFzc2VuZ2VyKHtcbi8vICAgICBuYW1lOiAnSmFrdWInLFxuLy8gICAgIGluaXRpYWxGbG9vcjogMCxcbi8vICAgICBkZXN0aW5hdGlvbkZsb29yOiAxLFxuLy8gfSlcbi8vIHN5c3RlbS5hZGROZXdFbGV2YXRvcigpO1xuLy8gc3lzdGVtLmFkZE5ld0VsZXZhdG9yKCk7XG4vLyBzeXN0ZW0uYWRkTmV3UGFzc2VuZ2VyKHtcbi8vICAgbmFtZTogXCJKYWt1YlwiLFxuLy8gICBpbml0aWFsRmxvb3I6IDIsXG4vLyAgIGRlc3RpbmF0aW9uRmxvb3I6IDQsXG4vLyB9KTtcbi8vIHN5c3RlbS5hZGROZXdQYXNzZW5nZXIoe1xuLy8gICBuYW1lOiBcIlBhd2XFglwiLFxuLy8gICBpbml0aWFsRmxvb3I6IDYsXG4vLyAgIGRlc3RpbmF0aW9uRmxvb3I6IDMsXG4vLyB9KTtcbi8vIHN5c3RlbS5hZGROZXdQYXNzZW5nZXIoe1xuLy8gICBuYW1lOiBcIlBpb3RyXCIsXG4vLyAgIGluaXRpYWxGbG9vcjogNyxcbi8vICAgZGVzdGluYXRpb25GbG9vcjogMyxcbi8vIH0pO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==